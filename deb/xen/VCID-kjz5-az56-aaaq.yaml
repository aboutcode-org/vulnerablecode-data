affected_purls: []
aliases:
- CVE-2018-12892
fixed_purl:
- pkg:deb/debian/xen@4.11.4%2B107-gef32c7afa2-1?distro=sid
- pkg:deb/debian/xen@4.14.5%2B94-ge49571868d-1?distro=sid
- pkg:deb/debian/xen@4.17.1%2B2-gb773c48e36-1?distro=sid
- pkg:deb/debian/xen@4.8.3%2Bxsa267%2Bshim4.10.1%2Bxsa267-1%2Bdeb9u9?distro=sid
references: []
severities: []
summary: An issue was discovered in Xen 4.7 through 4.10.x. libxl fails to pass the
  readonly flag to qemu when setting up a SCSI disk, due to what was probably an erroneous
  merge conflict resolution. Malicious guest administrators or (in some situations)
  users may be able to write to supposedly read-only disk images. Only emulated SCSI
  disks (specified as "sd" in the libxl disk configuration, or an equivalent) are
  affected. IDE disks ("hd") are not affected (because attempts to make them readonly
  are rejected). Additionally, CDROM devices (that is, devices specified to be presented
  to the guest as CDROMs, regardless of the nature of the backing storage on the host)
  are not affected; they are always read only. Only systems using qemu-xen (rather
  than qemu-xen-traditional) as the device model version are vulnerable. Only systems
  using libxl or libxl-based toolstacks are vulnerable. (This includes xl, and libvirt
  with the libxl driver.) The vulnerability is present in Xen versions 4.7 and later.
  (In earlier versions, provided that the patch for XSA-142 has been applied, attempts
  to create read only disks are rejected.) If the host and guest together usually
  support PVHVM, the issue is exploitable only if the malicious guest administrator
  has control of the guest kernel or guest kernel command line.
vulnerability_id: VCID-kjz5-az56-aaaq
weaknesses: []
