affected_purls: []
aliases:
- CVE-2020-15567
fixed_purl:
- pkg:deb/debian/xen@4.11.4%2B107-gef32c7afa2-1?distro=sid
- pkg:deb/debian/xen@4.11.4%2B24-gddaaccbbab-1?distro=sid
- pkg:deb/debian/xen@4.11.4%2B24-gddaaccbbab-1~deb10u1?distro=sid
- pkg:deb/debian/xen@4.14.5%2B94-ge49571868d-1?distro=sid
- pkg:deb/debian/xen@4.17.1%2B2-gb773c48e36-1?distro=sid
references: []
severities: []
summary: An issue was discovered in Xen through 4.13.x, allowing Intel guest OS users
  to gain privileges or cause a denial of service because of non-atomic modification
  of a live EPT PTE. When mapping guest EPT (nested paging) tables, Xen would in some
  circumstances use a series of non-atomic bitfield writes. Depending on the compiler
  version and optimisation flags, Xen might expose a dangerous partially written PTE
  to the hardware, which an attacker might be able to race to exploit. A guest administrator
  or perhaps even an unprivileged guest user might be able to cause denial of service,
  data corruption, or privilege escalation. Only systems using Intel CPUs are vulnerable.
  Systems using AMD CPUs, and Arm systems, are not vulnerable. Only systems using
  nested paging (hap, aka nested paging, aka in this case Intel EPT) are vulnerable.
  Only HVM and PVH guests can exploit the vulnerability. The presence and scope of
  the vulnerability depends on the precise optimisations performed by the compiler
  used to build Xen. If the compiler generates (a) a single 64-bit write, or (b) a
  series of read-modify-write operations in the same order as the source code, the
  hypervisor is not vulnerable. For example, in one test build using GCC 8.3 with
  normal settings, the compiler generated multiple (unlocked) read-modify-write operations
  in source-code order, which did not constitute a vulnerability. We have not been
  able to survey compilers; consequently we cannot say which compiler(s) might produce
  vulnerable code (with which code-generation options). The source code clearly violates
  the C rules, and thus should be considered vulnerable.
vulnerability_id: VCID-fjjf-grhh-aaas
weaknesses: []
