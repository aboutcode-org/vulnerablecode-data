vulnerability_id: VCID-mqzs-uyaw-aaac
aliases:
  - CVE-2017-1000112
summary: 'Linux kernel: Exploitable memory corruption due to UFO to non-UFO path switch. When
  building a UFO packet with MSG_MORE __ip_append_data() calls ip_ufo_append_data() to append.
  However in between two send() calls, the append path can be switched from UFO to non-UFO one,
  which leads to a memory corruption. In case UFO packet lengths exceeds MTU, copy = maxfraglen
  - skb->len becomes negative on the non-UFO path and the branch to allocate new skb is taken.
  This triggers fragmentation and computation of fraggap = skb_prev->len - maxfraglen. Fraggap
  can exceed MTU, causing copy = datalen - transhdrlen - fraggap to become negative. Subsequently
  skb_copy_and_csum_bits() writes out-of-bounds. A similar issue is present in IPv6 code. The
  bug was introduced in e89e9cf539a2 ("[IPv4/IPv6]: UFO Scatter-gather approach") on Oct 18
  2005.'
severities:
  - id: 673028
    reference_id: 1438227
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 621358
    reference_id: 939571
    scoring_system: cvssv3
    value: '7.0'
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  - id: 673029
    reference_id: 1438228
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673030
    reference_id: 1438229
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673022
    reference_id: 1438221
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673023
    reference_id: 1438222
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673024
    reference_id: 1438223
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673025
    reference_id: 1438224
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673026
    reference_id: 1438225
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 673027
    reference_id: 1438226
    scoring_system: generic_textual
    value: High
    scoring_elements:
  - id: 621355
    reference_id: 939568
    scoring_system: rhbs
    value: high
    scoring_elements:
  - id: 249408
    reference_id: 668157
    scoring_system: cvssv2
    value: '6.9'
    scoring_elements: AV:L/AC:M/Au:N/C:C/I:C/A:C
  - id: 249406
    reference_id: 668157
    scoring_system: cvssv3
    value: '7.0'
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H
  - id: 620891
    reference_id: 939244
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 621081
    reference_id: 939378
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 621082
    reference_id: 939379
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 621083
    reference_id: 939380
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 621357
    reference_id: 939570
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 621356
    reference_id: 939569
    scoring_system: rhas
    value: Important
    scoring_elements:
references:
  - id: 1438227
    url: http://people.canonical.com/~ubuntu-security/cve/2017/CVE-2017-1000112.html
    reference_id:
  - id: 668154
    url: https://access.redhat.com/errata/RHSA-2019:4159
    reference_id:
  - id: 939571
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2017-1000112.json
    reference_id:
  - id: 1438228
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-1000112
    reference_id:
  - id: 668149
    url: http://seclists.org/oss-sec/2017/q3/277
    reference_id:
  - id: 668155
    url: https://github.com/xairy/kernel-exploits/tree/master/CVE-2017-1000112
    reference_id:
  - id: 1438229
    url: https://git.kernel.org/pub/scm/linux/kernel/git/davem/net.git/commit/?id=85f1bd9a7b5a79d5baa8bf44af19658f7bf77bfa
    reference_id:
  - id: 1438221
    url: https://ubuntu.com/security/notices/USN-3384-1
    reference_id:
  - id: 1438222
    url: https://ubuntu.com/security/notices/USN-3384-2
    reference_id:
  - id: 1438223
    url: https://ubuntu.com/security/notices/USN-3385-1
    reference_id:
  - id: 1438224
    url: https://ubuntu.com/security/notices/USN-3385-2
    reference_id:
  - id: 1438225
    url: https://ubuntu.com/security/notices/USN-3386-1
    reference_id:
  - id: 1438226
    url: https://ubuntu.com/security/notices/USN-3386-2
    reference_id:
  - id: 668156
    url: https://www.exploit-db.com/exploits/45147/
    reference_id:
  - id: 668142
    url: http://www.debian.org/security/2017/dsa-3981
    reference_id:
  - id: 668150
    url: http://www.securityfocus.com/bid/100262
    reference_id:
  - id: 668151
    url: http://www.securitytracker.com/id/1039162
    reference_id:
  - id: 939568
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1479307
    reference_id: 1479307
  - id: 44691
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:linux:linux_kernel:*:*:*:*:*:*:*:*
  - id: 668157
    url: https://nvd.nist.gov/vuln/detail/CVE-2017-1000112
    reference_id: CVE-2017-1000112
  - id: 939244
    url: https://access.redhat.com/errata/RHSA-2017:2918
    reference_id: RHSA-2017:2918
  - id: 939378
    url: https://access.redhat.com/errata/RHSA-2017:2930
    reference_id: RHSA-2017:2930
  - id: 939379
    url: https://access.redhat.com/errata/RHSA-2017:2931
    reference_id: RHSA-2017:2931
  - id: 939380
    url: https://access.redhat.com/errata/RHSA-2017:3200
    reference_id: RHSA-2017:3200
  - id: 939570
    url: https://access.redhat.com/errata/RHSA-2019:1931
    reference_id: RHSA-2019:1931
  - id: 939569
    url: https://access.redhat.com/errata/RHSA-2019:1932
    reference_id: RHSA-2019:1932
weaknesses: []
