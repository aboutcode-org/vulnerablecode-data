affected_purls: []
aliases:
- CVE-2021-41253
fixed_purl:
- pkg:deb/debian/zydis@3.2.1-1?distro=sid
- pkg:deb/debian/zydis@4.0.0-1?distro=sid
references:
- id: 130073
  reference_id: '999431'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=999431
severities: []
summary: Zydis is an x86/x86-64 disassembler library. Users of Zydis versions v3.2.0
  and older that use the string functions provided in `zycore` in order to append
  untrusted user data to the formatter buffer within their custom formatter hooks
  can run into heap buffer overflows. Older versions of Zydis failed to properly initialize
  the string object within the formatter buffer, forgetting to initialize a few fields,
  leaving their value to chance. This could then in turn cause zycore functions like
  `ZyanStringAppend` to make incorrect calculations for the new target size, resulting
  in heap memory corruption. This does not affect the regular uncustomized Zydis formatter,
  because Zydis internally doesn't use the string functions in zycore that act upon
  these fields. However, because the zycore string functions are the intended way
  to work with the formatter buffer for users of the library that wish to extend the
  formatter, we still consider this to be a vulnerability in Zydis. This bug is patched
  starting in version 3.2.1. As a workaround, users may refrain from using zycore
  string functions in their formatter hooks until updating to a patched version.
vulnerability_id: VCID-b54s-2gc7-aaac
weaknesses: []
