affected_purls:
- pkg:npm/tar@0.0.1
- pkg:npm/tar@0.1.0
- pkg:npm/tar@0.1.10
- pkg:npm/tar@0.1.11
- pkg:npm/tar@0.1.12
- pkg:npm/tar@0.1.13
- pkg:npm/tar@0.1.14
- pkg:npm/tar@0.1.15
- pkg:npm/tar@0.1.16
- pkg:npm/tar@0.1.17
- pkg:npm/tar@0.1.18
- pkg:npm/tar@0.1.19
- pkg:npm/tar@0.1.2
- pkg:npm/tar@0.1.20
- pkg:npm/tar@0.1.3
- pkg:npm/tar@0.1.4
- pkg:npm/tar@0.1.5
- pkg:npm/tar@0.1.6
- pkg:npm/tar@0.1.7
- pkg:npm/tar@0.1.8
- pkg:npm/tar@0.1.9
- pkg:npm/tar@1.0.0
- pkg:npm/tar@1.0.1
- pkg:npm/tar@1.0.2
- pkg:npm/tar@1.0.3
- pkg:npm/tar@2.0.0
- pkg:npm/tar@2.0.1
- pkg:npm/tar@2.1.0
- pkg:npm/tar@2.1.1
- pkg:npm/tar@2.2.0
- pkg:npm/tar@2.2.1
- pkg:npm/tar@2.2.2
- pkg:npm/tar@3.0.0
- pkg:npm/tar@3.0.1
- pkg:npm/tar@3.1.0
- pkg:npm/tar@3.1.1
- pkg:npm/tar@3.1.10
- pkg:npm/tar@3.1.11
- pkg:npm/tar@3.1.12
- pkg:npm/tar@3.1.13
- pkg:npm/tar@3.1.14
- pkg:npm/tar@3.1.15
- pkg:npm/tar@3.1.2
- pkg:npm/tar@3.1.3
- pkg:npm/tar@3.1.4
- pkg:npm/tar@3.1.5
- pkg:npm/tar@3.1.6
- pkg:npm/tar@3.1.7
- pkg:npm/tar@3.1.8
- pkg:npm/tar@3.1.9
- pkg:npm/tar@3.2.0
- pkg:npm/tar@3.2.1
- pkg:npm/tar@3.2.2
- pkg:npm/tar@4.0.0
- pkg:npm/tar@4.0.1
- pkg:npm/tar@4.0.2
- pkg:npm/tar@4.1.0
- pkg:npm/tar@4.1.1
- pkg:npm/tar@4.1.2
- pkg:npm/tar@4.2.0
- pkg:npm/tar@4.3.0
- pkg:npm/tar@4.3.1
- pkg:npm/tar@4.3.2
- pkg:npm/tar@4.3.3
- pkg:npm/tar@4.4.0
- pkg:npm/tar@4.4.1
- pkg:npm/tar@4.4.10
- pkg:npm/tar@4.4.11
- pkg:npm/tar@4.4.12
- pkg:npm/tar@4.4.13
- pkg:npm/tar@4.4.14
- pkg:npm/tar@4.4.2
- pkg:npm/tar@4.4.3
- pkg:npm/tar@4.4.4
- pkg:npm/tar@4.4.5
- pkg:npm/tar@4.4.6
- pkg:npm/tar@4.4.7
- pkg:npm/tar@4.4.8
- pkg:npm/tar@4.4.9
- pkg:npm/tar@5.0.0
- pkg:npm/tar@5.0.1
- pkg:npm/tar@5.0.2
- pkg:npm/tar@5.0.4
- pkg:npm/tar@5.0.5
- pkg:npm/tar@5.0.6
- pkg:npm/tar@6.0.0
- pkg:npm/tar@6.0.1
- pkg:npm/tar@6.0.2
- pkg:npm/tar@6.0.3
- pkg:npm/tar@6.0.4
- pkg:npm/tar@6.0.5
- pkg:npm/tar@6.1.0
- pkg:npm/tar@6.1.1
aliases:
- CVE-2021-32803
- GHSA-r628-mhmh-qjhw
fixed_purl:
- pkg:deb/debian/node-tar@4.4.6%2Bds1-3%2Bdeb10u1?distro=sid
- pkg:deb/debian/node-tar@6.0.5%2Bds1%2B~cs11.3.9-1%2Bdeb11u1?distro=sid
- pkg:deb/debian/node-tar@6.0.5%2Bds1%2B~cs11.3.9-1%2Bdeb11u2?distro=sid
- pkg:deb/debian/node-tar@6.1.13%2B~cs7.0.5-1?distro=sid
- pkg:deb/debian/node-tar@6.1.7%2B~cs11.3.10-1?distro=sid
- pkg:npm/tar@3.2.3
- pkg:npm/tar@4.4.15
- pkg:npm/tar@5.0.7
- pkg:npm/tar@6.1.2
references:
- id: 155947
  reference_id: ''
  url: https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf
- id: 161106
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/46fe35083e2676e31c4e0a81639dce6da7aaa356
- id: 161107
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/5987d9a41f6bfbf1ddab1098e1fdcf1a5618f571
- id: 161108
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/85d3a942b4064e4ff171f91696fced7975167349
- id: 161109
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20
- id: 161102
  reference_id: ''
  url: https://github.com/npm/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20
- id: 161103
  reference_id: ''
  url: https://www.npmjs.com/advisories/1771
- id: 161105
  reference_id: ''
  url: https://www.npmjs.com/package/tar
- id: 136182
  reference_id: ''
  url: https://www.oracle.com/security-alerts/cpuoct2021.html
- id: 129818
  reference_id: '992110'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=992110
- id: 161104
  reference_id: CVE-2021-32803
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-32803
- id: 161110
  reference_id: GHSA-r628-mhmh-qjhw
  url: https://github.com/advisories/GHSA-r628-mhmh-qjhw
- id: 161101
  reference_id: GHSA-r628-mhmh-qjhw
  url: https://github.com/npm/node-tar/security/advisories/GHSA-r628-mhmh-qjhw
severities:
- id: 23731
  reference_id: 161110
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
- id: 23730
  reference_id: 161101
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
summary: The npm package "tar" (aka node-tar) before versions 6.1.2, 5.0.7, 4.4.15,
  and 3.2.3 has an arbitrary File Creation/Overwrite vulnerability via insufficient
  symlink protection. `node-tar` aims to guarantee that any file whose location would
  be modified by a symbolic link is not extracted. This is, in part, achieved by ensuring
  that extracted directories are not symlinks. Additionally, in order to prevent unnecessary
  `stat` calls to determine whether a given path is a directory, paths are cached
  when directories are created. This logic was insufficient when extracting tar files
  that contained both a directory and a symlink with the same name as the directory.
  This order of operations resulted in the directory being created and added to the
  `node-tar` directory cache. When a directory is present in the directory cache,
  subsequent calls to mkdir for that directory are skipped. However, this is also
  where `node-tar` checks for symlinks occur. By first creating a directory, and then
  replacing that directory with a symlink, it was thus possible to bypass `node-tar`
  symlink checks on directories, essentially allowing an untrusted tar file to symlink
  into an arbitrary location and subsequently extracting arbitrary files into that
  location, thus allowing arbitrary file creation and overwrite. This issue was addressed
  in releases 3.2.3, 4.4.15, 5.0.7 and 6.1.2.
vulnerability_id: VCID-68v6-2jjq-aaap
weaknesses: []
