affected_purls:
- pkg:npm/tar@0.0.1
- pkg:npm/tar@0.1.0
- pkg:npm/tar@0.1.10
- pkg:npm/tar@0.1.11
- pkg:npm/tar@0.1.12
- pkg:npm/tar@0.1.13
- pkg:npm/tar@0.1.14
- pkg:npm/tar@0.1.15
- pkg:npm/tar@0.1.16
- pkg:npm/tar@0.1.17
- pkg:npm/tar@0.1.18
- pkg:npm/tar@0.1.19
- pkg:npm/tar@0.1.2
- pkg:npm/tar@0.1.20
- pkg:npm/tar@0.1.3
- pkg:npm/tar@0.1.4
- pkg:npm/tar@0.1.5
- pkg:npm/tar@0.1.6
- pkg:npm/tar@0.1.7
- pkg:npm/tar@0.1.8
- pkg:npm/tar@0.1.9
- pkg:npm/tar@1.0.0
- pkg:npm/tar@1.0.1
- pkg:npm/tar@1.0.2
- pkg:npm/tar@1.0.3
- pkg:npm/tar@2.0.0
- pkg:npm/tar@2.0.1
- pkg:npm/tar@2.1.0
- pkg:npm/tar@2.1.1
- pkg:npm/tar@2.2.0
- pkg:npm/tar@2.2.1
- pkg:npm/tar@2.2.2
- pkg:npm/tar@3.0.0
- pkg:npm/tar@3.0.1
- pkg:npm/tar@3.1.0
- pkg:npm/tar@3.1.1
- pkg:npm/tar@3.1.10
- pkg:npm/tar@3.1.11
- pkg:npm/tar@3.1.12
- pkg:npm/tar@3.1.13
- pkg:npm/tar@3.1.14
- pkg:npm/tar@3.1.15
- pkg:npm/tar@3.1.2
- pkg:npm/tar@3.1.3
- pkg:npm/tar@3.1.4
- pkg:npm/tar@3.1.5
- pkg:npm/tar@3.1.6
- pkg:npm/tar@3.1.7
- pkg:npm/tar@3.1.8
- pkg:npm/tar@3.1.9
- pkg:npm/tar@3.2.0
- pkg:npm/tar@3.2.1
- pkg:npm/tar@3.2.2
- pkg:npm/tar@3.2.3
- pkg:npm/tar@4.0.0
- pkg:npm/tar@4.0.1
- pkg:npm/tar@4.0.2
- pkg:npm/tar@4.1.0
- pkg:npm/tar@4.1.1
- pkg:npm/tar@4.1.2
- pkg:npm/tar@4.2.0
- pkg:npm/tar@4.3.0
- pkg:npm/tar@4.3.1
- pkg:npm/tar@4.3.2
- pkg:npm/tar@4.3.3
- pkg:npm/tar@4.4.0
- pkg:npm/tar@4.4.1
- pkg:npm/tar@4.4.10
- pkg:npm/tar@4.4.11
- pkg:npm/tar@4.4.12
- pkg:npm/tar@4.4.13
- pkg:npm/tar@4.4.14
- pkg:npm/tar@4.4.15
- pkg:npm/tar@4.4.16
- pkg:npm/tar@4.4.17
- pkg:npm/tar@4.4.2
- pkg:npm/tar@4.4.3
- pkg:npm/tar@4.4.4
- pkg:npm/tar@4.4.5
- pkg:npm/tar@4.4.6
- pkg:npm/tar@4.4.7
- pkg:npm/tar@4.4.8
- pkg:npm/tar@4.4.9
- pkg:npm/tar@5.0.0
- pkg:npm/tar@5.0.1
- pkg:npm/tar@5.0.2
- pkg:npm/tar@5.0.4
- pkg:npm/tar@5.0.5
- pkg:npm/tar@5.0.6
- pkg:npm/tar@5.0.7
- pkg:npm/tar@5.0.8
- pkg:npm/tar@5.0.9
- pkg:npm/tar@6.0.0
- pkg:npm/tar@6.0.1
- pkg:npm/tar@6.0.2
- pkg:npm/tar@6.0.3
- pkg:npm/tar@6.0.4
- pkg:npm/tar@6.0.5
- pkg:npm/tar@6.1.0
- pkg:npm/tar@6.1.1
- pkg:npm/tar@6.1.2
- pkg:npm/tar@6.1.3
- pkg:npm/tar@6.1.4
- pkg:npm/tar@6.1.5
- pkg:npm/tar@6.1.6
- pkg:npm/tar@6.1.7
- pkg:npm/tar@6.1.8
aliases:
- CVE-2021-37712
- GHSA-qq89-hq3f-393p
fixed_purl:
- pkg:deb/debian/node-tar@4.4.6%2Bds1-3%2Bdeb10u1?distro=sid
- pkg:deb/debian/node-tar@4.4.6%2Bds1-3%2Bdeb10u2?distro=sid
- pkg:deb/debian/node-tar@6.0.5%2Bds1%2B~cs11.3.9-1%2Bdeb11u2?distro=sid
- pkg:deb/debian/node-tar@6.1.11%2B~cs11.3.10-1?distro=sid
- pkg:deb/debian/node-tar@6.1.13%2B~cs7.0.5-1?distro=sid
- pkg:npm/tar@4.4.18
- pkg:npm/tar@5.0.10
- pkg:npm/tar@6.1.9
references:
- id: 155947
  reference_id: ''
  url: https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf
- id: 162502
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/1739408d3122af897caefd09662bce2ea477533b
- id: 162503
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/b6162c7fafe797f856564ef37f4b82747f051455
- id: 162504
  reference_id: ''
  url: https://github.com/isaacs/node-tar/commit/bb93ba243746f705092905da1955ac3b0509ba1e
- id: 162457
  reference_id: ''
  url: https://lists.debian.org/debian-lts-announce/2022/12/msg00023.html
- id: 162456
  reference_id: ''
  url: https://www.debian.org/security/2021/dsa-5008
- id: 161105
  reference_id: ''
  url: https://www.npmjs.com/package/tar
- id: 136182
  reference_id: ''
  url: https://www.oracle.com/security-alerts/cpuoct2021.html
- id: 129990
  reference_id: '993981'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993981
- id: 162501
  reference_id: CVE-2021-37712
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-37712
- id: 162505
  reference_id: GHSA-qq89-hq3f-393p
  url: https://github.com/advisories/GHSA-qq89-hq3f-393p
- id: 162500
  reference_id: GHSA-qq89-hq3f-393p
  url: https://github.com/npm/node-tar/security/advisories/GHSA-qq89-hq3f-393p
severities:
- id: 24114
  reference_id: 162505
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
- id: 24113
  reference_id: 162500
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
summary: The npm package "tar" (aka node-tar) before versions 4.4.18, 5.0.10, and
  6.1.9 has an arbitrary file creation/overwrite and arbitrary code execution vulnerability.
  node-tar aims to guarantee that any file whose location would be modified by a symbolic
  link is not extracted. This is, in part, achieved by ensuring that extracted directories
  are not symlinks. Additionally, in order to prevent unnecessary stat calls to determine
  whether a given path is a directory, paths are cached when directories are created.
  This logic was insufficient when extracting tar files that contained both a directory
  and a symlink with names containing unicode values that normalized to the same value.
  Additionally, on Windows systems, long path portions would resolve to the same file
  system entities as their 8.3 "short path" counterparts. A specially crafted tar
  archive could thus include a directory with one form of the path, followed by a
  symbolic link with a different string that resolves to the same file system entity,
  followed by a file using the first form. By first creating a directory, and then
  replacing that directory with a symlink that had a different apparent name that
  resolved to the same entry in the filesystem, it was thus possible to bypass node-tar
  symlink checks on directories, essentially allowing an untrusted tar file to symlink
  into an arbitrary location and subsequently extracting arbitrary files into that
  location, thus allowing arbitrary file creation and overwrite. These issues were
  addressed in releases 4.4.18, 5.0.10 and 6.1.9. The v3 branch of node-tar has been
  deprecated and did not receive patches for these issues. If you are still using
  a v3 release we recommend you update to a more recent version of node-tar. If this
  is not possible, a workaround is available in the referenced GHSA-qq89-hq3f-393p.
vulnerability_id: VCID-w2xs-wkm3-aaak
weaknesses: []
