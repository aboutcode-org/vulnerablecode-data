affected_purls:
- pkg:npm/tar@0.0.1
- pkg:npm/tar@0.1.0
- pkg:npm/tar@0.1.10
- pkg:npm/tar@0.1.11
- pkg:npm/tar@0.1.12
- pkg:npm/tar@0.1.13
- pkg:npm/tar@0.1.14
- pkg:npm/tar@0.1.15
- pkg:npm/tar@0.1.16
- pkg:npm/tar@0.1.17
- pkg:npm/tar@0.1.18
- pkg:npm/tar@0.1.19
- pkg:npm/tar@0.1.2
- pkg:npm/tar@0.1.20
- pkg:npm/tar@0.1.3
- pkg:npm/tar@0.1.4
- pkg:npm/tar@0.1.5
- pkg:npm/tar@0.1.6
- pkg:npm/tar@0.1.7
- pkg:npm/tar@0.1.8
- pkg:npm/tar@0.1.9
- pkg:npm/tar@1.0.0
- pkg:npm/tar@1.0.1
- pkg:npm/tar@1.0.2
- pkg:npm/tar@1.0.3
- pkg:npm/tar@2.0.0
- pkg:npm/tar@2.0.1
- pkg:npm/tar@2.1.0
- pkg:npm/tar@2.1.1
- pkg:npm/tar@2.2.0
- pkg:npm/tar@2.2.1
- pkg:npm/tar@2.2.2
- pkg:npm/tar@3.0.0
- pkg:npm/tar@3.0.1
- pkg:npm/tar@3.1.0
- pkg:npm/tar@3.1.1
- pkg:npm/tar@3.1.10
- pkg:npm/tar@3.1.11
- pkg:npm/tar@3.1.12
- pkg:npm/tar@3.1.13
- pkg:npm/tar@3.1.14
- pkg:npm/tar@3.1.15
- pkg:npm/tar@3.1.2
- pkg:npm/tar@3.1.3
- pkg:npm/tar@3.1.4
- pkg:npm/tar@3.1.5
- pkg:npm/tar@3.1.6
- pkg:npm/tar@3.1.7
- pkg:npm/tar@3.1.8
- pkg:npm/tar@3.1.9
- pkg:npm/tar@3.2.0
- pkg:npm/tar@3.2.1
- pkg:npm/tar@4.0.0
- pkg:npm/tar@4.0.1
- pkg:npm/tar@4.0.2
- pkg:npm/tar@4.1.0
- pkg:npm/tar@4.1.1
- pkg:npm/tar@4.1.2
- pkg:npm/tar@4.2.0
- pkg:npm/tar@4.3.0
- pkg:npm/tar@4.3.1
- pkg:npm/tar@4.3.2
- pkg:npm/tar@4.3.3
- pkg:npm/tar@4.4.0
- pkg:npm/tar@4.4.1
- pkg:npm/tar@4.4.10
- pkg:npm/tar@4.4.11
- pkg:npm/tar@4.4.12
- pkg:npm/tar@4.4.13
- pkg:npm/tar@4.4.2
- pkg:npm/tar@4.4.3
- pkg:npm/tar@4.4.4
- pkg:npm/tar@4.4.5
- pkg:npm/tar@4.4.6
- pkg:npm/tar@4.4.7
- pkg:npm/tar@4.4.8
- pkg:npm/tar@4.4.9
- pkg:npm/tar@5.0.0
- pkg:npm/tar@5.0.1
- pkg:npm/tar@5.0.2
- pkg:npm/tar@5.0.4
- pkg:npm/tar@5.0.5
- pkg:npm/tar@6.0.0
- pkg:npm/tar@6.0.1
- pkg:npm/tar@6.0.2
- pkg:npm/tar@6.0.3
- pkg:npm/tar@6.0.4
- pkg:npm/tar@6.0.5
- pkg:npm/tar@6.1.0
aliases:
- CVE-2021-32804
- GHSA-3jfq-g458-7qm9
fixed_purl:
- pkg:deb/debian/node-tar@4.4.6%2Bds1-3%2Bdeb10u1?distro=sid
- pkg:deb/debian/node-tar@6.0.5%2Bds1%2B~cs11.3.9-1%2Bdeb11u1?distro=sid
- pkg:deb/debian/node-tar@6.0.5%2Bds1%2B~cs11.3.9-1%2Bdeb11u2?distro=sid
- pkg:deb/debian/node-tar@6.1.13%2B~cs7.0.5-1?distro=sid
- pkg:deb/debian/node-tar@6.1.7%2B~cs11.3.10-1?distro=sid
- pkg:npm/tar@3.2.2
- pkg:npm/tar@4.4.14
- pkg:npm/tar@5.0.6
- pkg:npm/tar@6.1.1
references:
- id: 155947
  reference_id: ''
  url: https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf
- id: 161112
  reference_id: ''
  url: https://github.com/npm/node-tar/commit/1f036ca23f64a547bdd6c79c1a44bc62e8115da4
- id: 161113
  reference_id: ''
  url: https://www.npmjs.com/advisories/1770
- id: 161105
  reference_id: ''
  url: https://www.npmjs.com/package/tar
- id: 136182
  reference_id: ''
  url: https://www.oracle.com/security-alerts/cpuoct2021.html
- id: 129819
  reference_id: '992111'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=992111
- id: 161114
  reference_id: CVE-2021-32804
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-32804
- id: 161115
  reference_id: GHSA-3jfq-g458-7qm9
  url: https://github.com/advisories/GHSA-3jfq-g458-7qm9
- id: 161111
  reference_id: GHSA-3jfq-g458-7qm9
  url: https://github.com/npm/node-tar/security/advisories/GHSA-3jfq-g458-7qm9
severities:
- id: 23733
  reference_id: 161115
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
- id: 23732
  reference_id: 161111
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
summary: The npm package "tar" (aka node-tar) before versions 6.1.1, 5.0.6, 4.4.14,
  and 3.3.2 has a arbitrary File Creation/Overwrite vulnerability due to insufficient
  absolute path sanitization. node-tar aims to prevent extraction of absolute file
  paths by turning absolute paths into relative paths when the `preservePaths` flag
  is not set to `true`. This is achieved by stripping the absolute path root from
  any absolute file paths contained in a tar file. For example `/home/user/.bashrc`
  would turn into `home/user/.bashrc`. This logic was insufficient when file paths
  contained repeated path roots such as `////home/user/.bashrc`. `node-tar` would
  only strip a single path root from such paths. When given an absolute file path
  with repeating path roots, the resulting path (e.g. `///home/user/.bashrc`) would
  still resolve to an absolute path, thus allowing arbitrary file creation and overwrite.
  This issue was addressed in releases 3.2.2, 4.4.14, 5.0.6 and 6.1.1. Users may work
  around this vulnerability without upgrading by creating a custom `onentry` method
  which sanitizes the `entry.path` or a `filter` method which removes entries with
  absolute paths. See referenced GitHub Advisory for details. Be aware of CVE-2021-32803
  which fixes a similar bug in later versions of tar.
vulnerability_id: VCID-ujfp-3f2e-aaar
weaknesses: []
