affected_purls: []
aliases:
- CVE-2021-30159
fixed_purl:
- pkg:deb/debian/mediawiki@1:1.31.14-1~deb10u1?distro=sid
- pkg:deb/debian/mediawiki@1:1.31.16-1%2Bdeb10u2?distro=sid
- pkg:deb/debian/mediawiki@1:1.35.2-1?distro=sid
- pkg:deb/debian/mediawiki@1:1.35.8-1~deb11u1?distro=sid
- pkg:deb/debian/mediawiki@1:1.39.2-1?distro=sid
references: []
severities: []
summary: An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x
  before 1.35.2. Users can bypass intended restrictions on deleting pages in certain
  "fast double move" situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but
  it's only called if Title::getArticleID() returns non-zero with no special flags.
  Next, MovePage::moveToInternal() will delete the page if getArticleID(READ_LATEST)
  is non-zero. Therefore, if the page is missing in the replica DB, isValidMove()
  will return true, and then moveToInternal() will unconditionally delete the page
  if it can be found in the master.
vulnerability_id: VCID-nges-x5jc-aaae
weaknesses: []
