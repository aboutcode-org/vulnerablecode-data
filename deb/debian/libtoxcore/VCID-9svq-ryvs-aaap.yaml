vulnerability_id: VCID-9svq-ryvs-aaap
aliases:
  - CVE-2018-25022
summary: The Onion module in toxcore before 0.2.2 doesn't restrict which packets can be onion-routed,
  which allows a remote attacker to discover a target user's IP address (when knowing only their
  Tox Id) by positioning themselves close to target's Tox Id in the DHT for the target to establish
  an onion connection with the attacker, guessing the target's DHT public key and creating a
  DHT node with public key close to it, and finally onion-routing a NAT Ping Request to the
  target, requesting it to ping the just created DHT node.
severities:
  - id: 43826
    reference_id: 169178
    scoring_system: cvssv2
    value: '4.3'
    scoring_elements: AV:N/AC:M/Au:N/C:P/I:N/A:N
  - id: 43824
    reference_id: 169178
    scoring_system: cvssv3
    value: '3.1'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N
references:
  - id: 169175
    url: https://blog.tox.chat/2018/04/security-vulnerability-and-new-toxcore-release
    reference_id:
  - id: 169176
    url: https://github.com/TokTok/c-toxcore/issues/873
    reference_id:
  - id: 169177
    url: https://github.com/TokTok/c-toxcore/pull/872
    reference_id:
  - id: 169174
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:toktok:toxcore:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:toktok:toxcore:*:*:*:*:*:*:*:*
  - id: 169178
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-25022
    reference_id: CVE-2018-25022
weaknesses: []
