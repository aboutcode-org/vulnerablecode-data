vulnerability_id: VCID-5p8h-kwav-aaas
aliases:
  - CVE-2021-32803
  - GHSA-r628-mhmh-qjhw
summary: |
  Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')
  The npm package "tar" (aka node-tar) before versions 6.1.2, 5.0.7, 4.4.15, and 3.2.3 has an arbitrary File Creation/Overwrite vulnerability via insufficient symlink protection. `node-tar` aims to guarantee that any file whose location would be modified by a symbolic link is not extracted. This is, in part, achieved by ensuring that extracted directories are not symlinks. Additionally, in order to prevent unnecessary `stat` calls to determine whether a given path is a directory, paths are cached when directories are created. This logic was insufficient when extracting tar files that contained both a directory and a symlink with the same name as the directory. This order of operations resulted in the directory being created and added to the `node-tar` directory cache. When a directory is present in the directory cache, subsequent calls to mkdir for that directory are skipped. However, this is also where `node-tar` checks for symlinks occur. By first creating a directory, and then replacing that directory with a symlink, it was thus possible to bypass `node-tar` symlink checks on directories, essentially allowing an untrusted tar file to symlink into an arbitrary location and subsequently extracting arbitrary files into that location, thus allowing arbitrary file creation and overwrite. This issue was addressed in releases 3.2.3, 4.4.15, 5.0.7 and 6.1.2.
severities:
  - id: 603284
    reference_id: 926408
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
  - id: 701265
    reference_id: 387
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 603283
    reference_id: 926407
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 541025
    reference_id: 36260
    scoring_system: cvssv2
    value: '5.8'
    scoring_elements: AV:N/AC:M/Au:N/C:N/I:P/A:P
  - id: 541023
    reference_id: 36260
    scoring_system: cvssv3
    value: '8.1'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:H
  - id: 706753
    reference_id: 36261
    scoring_system: cvssv3.1_qr
    value: HIGH
    scoring_elements:
  - id: 603111
    reference_id: 926282
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 603110
    reference_id: 926281
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 603113
    reference_id: 926284
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 603109
    reference_id: 926280
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 603112
    reference_id: 926283
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 603114
    reference_id: 926285
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 602350
    reference_id: 925725
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 602732
    reference_id: 926010
    scoring_system: rhas
    value: Moderate
    scoring_elements:
references:
  - id: 926408
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-32803.json
    reference_id:
  - id: 21833
    url: https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf
    reference_id:
  - id: 1472561
    url: https://github.com/isaacs/node-tar/commit/46fe35083e2676e31c4e0a81639dce6da7aaa356
    reference_id:
  - id: 1472562
    url: https://github.com/isaacs/node-tar/commit/5987d9a41f6bfbf1ddab1098e1fdcf1a5618f571
    reference_id:
  - id: 1472563
    url: https://github.com/isaacs/node-tar/commit/85d3a942b4064e4ff171f91696fced7975167349
    reference_id:
  - id: 1472564
    url: https://github.com/isaacs/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20
    reference_id:
  - id: 36258
    url: https://github.com/npm/node-tar/commit/9dbdeb6df8e9dbd96fa9e84341b9d74734be6c20
    reference_id:
  - id: 885076
    url: https://github.com/npm/node-tar/security/advisories/GHSA-r628-mhmh-qjhw
    reference_id:
  - id: 36259
    url: https://www.npmjs.com/advisories/1771
    reference_id:
  - id: 36251
    url: https://www.npmjs.com/package/tar
    reference_id:
  - id: 387
    url: https://www.oracle.com/security-alerts/cpuoct2021.html
    reference_id:
  - id: 926407
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1990415
    reference_id: '1990415'
  - id: 78939
    url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=992110
    reference_id: 992110
  - id: 784227
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:oracle:graalvm:20.3.3:*:*:*:enterprise:*:*:*
    reference_id: cpe:2.3:a:oracle:graalvm:20.3.3:*:*:*:enterprise:*:*:*
  - id: 867566
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:oracle:graalvm:21.2.0:*:*:*:enterprise:*:*:*
    reference_id: cpe:2.3:a:oracle:graalvm:21.2.0:*:*:*:enterprise:*:*:*
  - id: 789601
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:siemens:sinec_infrastructure_network_services:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:siemens:sinec_infrastructure_network_services:*:*:*:*:*:*:*:*
  - id: 885077
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*
    reference_id: cpe:2.3:a:tar_project:tar:*:*:*:*:*:node.js:*:*
  - id: 36260
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-32803
    reference_id: CVE-2021-32803
  - id: 36261
    url: https://github.com/advisories/GHSA-r628-mhmh-qjhw
    reference_id: GHSA-r628-mhmh-qjhw
  - id: 926282
    url: https://access.redhat.com/errata/RHSA-2021:3280
    reference_id: RHSA-2021:3280
  - id: 926281
    url: https://access.redhat.com/errata/RHSA-2021:3281
    reference_id: RHSA-2021:3281
  - id: 926284
    url: https://access.redhat.com/errata/RHSA-2021:3623
    reference_id: RHSA-2021:3623
  - id: 926280
    url: https://access.redhat.com/errata/RHSA-2021:3638
    reference_id: RHSA-2021:3638
  - id: 926283
    url: https://access.redhat.com/errata/RHSA-2021:3639
    reference_id: RHSA-2021:3639
  - id: 926285
    url: https://access.redhat.com/errata/RHSA-2021:3666
    reference_id: RHSA-2021:3666
  - id: 925725
    url: https://access.redhat.com/errata/RHSA-2021:4618
    reference_id: RHSA-2021:4618
  - id: 926010
    url: https://access.redhat.com/errata/RHSA-2021:5086
    reference_id: RHSA-2021:5086
weaknesses: []
