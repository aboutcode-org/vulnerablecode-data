vulnerability_id: VCID-jgr8-gtha-aaaq
aliases:
  - CVE-2022-21658
summary: 'Rust is a multi-paradigm, general-purpose programming language designed for performance
  and safety, especially safe concurrency. The Rust Security Response WG was notified that the
  `std::fs::remove_dir_all` standard library function is vulnerable a race condition enabling
  symlink following (CWE-363). An attacker could use this security issue to trick a privileged
  program into deleting files and directories the attacker couldn''t otherwise access or delete.
  Rust 1.0.0 through Rust 1.58.0 is affected by this vulnerability with 1.58.1 containing a
  patch. Note that the following build targets don''t have usable APIs to properly mitigate
  the attack, and are thus still vulnerable even with a patched toolchain: macOS before version
  10.10 (Yosemite) and REDOX. We recommend everyone to update to Rust 1.58.1 as soon as possible,
  especially people developing programs expected to run in privileged contexts (including system
  daemons and setuid binaries), as those have the highest risk of being affected by this. Note
  that adding checks in your codebase before calling remove_dir_all will not mitigate the vulnerability,
  as they would also be vulnerable to race conditions like remove_dir_all itself. The existing
  mitigation is working as intended outside of race conditions.'
severities:
  - id: 295753
    reference_id: 710944
    scoring_system: cvssv3
    value: '5.3'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N
  - id: 295751
    reference_id: 710942
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 582697
    reference_id: 912822
    scoring_system: cvssv2
    value: '3.3'
    scoring_elements: AV:L/AC:M/Au:N/C:N/I:P/A:P
  - id: 582695
    reference_id: 912822
    scoring_system: cvssv3
    value: '6.3'
    scoring_elements: CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:H
  - id: 295752
    reference_id: 710943
    scoring_system: rhas
    value: Moderate
    scoring_elements:
references:
  - id: 710944
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-21658.json
    reference_id:
  - id: 912811
    url: https://blog.rust-lang.org/2022/01/20/cve-2022-21658.html
    reference_id:
  - id: 912812
    url: https://github.com/rust-lang/rust/pull/93110
    reference_id:
  - id: 912813
    url: https://github.com/rust-lang/rust/pull/93110/commits/32ed6e599bb4722efefd78bbc9cd7ec4613cb946
    reference_id:
  - id: 912814
    url: https://github.com/rust-lang/rust/pull/93110/commits/406cc071d6cfdfdb678bf3d83d766851de95abaf
    reference_id:
  - id: 912815
    url: https://github.com/rust-lang/rust/pull/93110/commits/4f0ad1c92ca08da6e8dc17838070975762f59714
    reference_id:
  - id: 912816
    url: https://github.com/rust-lang/rust/security/advisories/GHSA-r9cc-f5pr-p3j2
    reference_id:
  - id: 912817
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7JKZDTBMGAWIFJSNWKBMPO5EAKRR4BEW/
    reference_id:
  - id: 912818
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/BK32QZLHDC2OVLPKTUHNT2G3VHWHD4LX/
    reference_id:
  - id: 912819
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/C63NH72Q7UHJM5V3IVYRI7LVBGGFQMSQ/
    reference_id:
  - id: 912820
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CKGTACKMKAPRDPWPTU26GYWBELIRFF5N/
    reference_id:
  - id: 891320
    url: https://support.apple.com/kb/HT213182
    reference_id:
  - id: 867588
    url: https://support.apple.com/kb/HT213183
    reference_id:
  - id: 912821
    url: https://support.apple.com/kb/HT213186
    reference_id:
  - id: 891321
    url: https://support.apple.com/kb/HT213193
    reference_id:
  - id: 710942
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2041504
    reference_id: 2041504
  - id: 169110
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:rust-lang:rust:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:rust-lang:rust:*:*:*:*:*:*:*:*
  - id: 169238
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - id: 169239
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*
  - id: 912822
    url: https://nvd.nist.gov/vuln/detail/CVE-2022-21658
    reference_id: CVE-2022-21658
  - id: 710943
    url: https://access.redhat.com/errata/RHSA-2022:1894
    reference_id: RHSA-2022:1894
weaknesses: []
