vulnerability_id: VCID-5jzt-tdht-aaaq
aliases:
  - CVE-2018-16872
summary: A flaw was found in qemu Media Transfer Protocol (MTP). The code opening files in usb_mtp_get_object
  and usb_mtp_get_partial_object and directories in usb_mtp_object_readdir doesn't consider
  that the underlying filesystem may have changed since the time lstat(2) was called in usb_mtp_object_alloc,
  a classical TOCTTOU problem. An attacker with write access to the host filesystem shared with
  a guest can use this property to navigate the host filesystem in the context of the QEMU process
  and read any file the QEMU process has access to. Access to the filesystem may be local or
  via a network share protocol such as CIFS.
severities:
  - id: 685176
    reference_id: 1447603
    scoring_system: generic_textual
    value: Low
    scoring_elements:
  - id: 608271
    reference_id: 930076
    scoring_system: cvssv3
    value: '5.0'
    scoring_elements: CVSS:3.0/AV:L/AC:H/PR:H/UI:N/S:C/C:L/I:L/A:L
  - id: 685177
    reference_id: 1447604
    scoring_system: generic_textual
    value: Low
    scoring_elements:
  - id: 685178
    reference_id: 1447605
    scoring_system: generic_textual
    value: Low
    scoring_elements:
  - id: 685179
    reference_id: 1447606
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 685180
    reference_id: 1447607
    scoring_system: generic_textual
    value: Low
    scoring_elements:
  - id: 608270
    reference_id: 930075
    scoring_system: rhbs
    value: low
    scoring_elements:
  - id: 331084
    reference_id: 740062
    scoring_system: cvssv2
    value: '3.5'
    scoring_elements: AV:N/AC:M/Au:S/C:P/I:N/A:N
  - id: 331082
    reference_id: 740062
    scoring_system: cvssv3
    value: '5.3'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N
references:
  - id: 680156
    url: http://lists.opensuse.org/opensuse-security-announce/2019-03/msg00042.html
    reference_id:
  - id: 1447603
    url: http://people.canonical.com/~ubuntu-security/cve/2018/CVE-2018-16872.html
    reference_id:
  - id: 930076
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2018-16872.json
    reference_id:
  - id: 740060
    url: https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-16872
    reference_id:
  - id: 1447604
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-16872
    reference_id:
  - id: 730066
    url: https://lists.debian.org/debian-lts-announce/2019/02/msg00041.html
    reference_id:
  - id: 740036
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/CGCFIFSIWUREEQQOZDZFBYKWZHXCWBZN/
    reference_id:
  - id: 740061
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KJMTVGDLA654HNCDGLCUEIP36SNJEKK7/
    reference_id:
  - id: 1447605
    url: https://lists.gnu.org/archive/html/qemu-devel/2018-12/msg03135.html
    reference_id:
  - id: 727966
    url: https://seclists.org/bugtraq/2019/May/76
    reference_id:
  - id: 1447606
    url: https://ubuntu.com/security/notices/USN-3923-1
    reference_id:
  - id: 740037
    url: https://usn.ubuntu.com/3923-1/
    reference_id:
  - id: 727967
    url: https://www.debian.org/security/2019/dsa-4454
    reference_id:
  - id: 1447607
    url: https://www.openwall.com/lists/oss-security/2018/12/13/11
    reference_id:
  - id: 740059
    url: http://www.securityfocus.com/bid/106212
    reference_id:
  - id: 930075
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1656114
    reference_id: 1656114
  - id: 112063
    url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=916397
    reference_id: 916397
  - id: 158174
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:qemu:qemu:*:*:*:*:*:*:*:*
  - id: 147843
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:14.04:*:*:*:lts:*:*:*
  - id: 147844
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - id: 168169
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - id: 168170
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.10:*:*:*:*:*:*:*
  - id: 79275
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:8.0:*:*:*:*:*:*:*
  - id: 127310
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - id: 641049
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:29:*:*:*:*:*:*:*
  - id: 641050
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:30:*:*:*:*:*:*:*
  - id: 614332
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:opensuse:leap:42.3:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:opensuse:leap:42.3:*:*:*:*:*:*:*
  - id: 740062
    url: https://nvd.nist.gov/vuln/detail/CVE-2018-16872
    reference_id: CVE-2018-16872
weaknesses: []
