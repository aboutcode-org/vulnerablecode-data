vulnerability_id: VCID-zyhx-9g42-aaae
aliases:
  - CVE-2021-30159
summary: An issue was discovered in MediaWiki before 1.31.12 and 1.32.x through 1.35.x before
  1.35.2. Users can bypass intended restrictions on deleting pages in certain "fast double move"
  situations. MovePage::isValidMoveTarget() uses FOR UPDATE, but it's only called if Title::getArticleID()
  returns non-zero with no special flags. Next, MovePage::moveToInternal() will delete the page
  if getArticleID(READ_LATEST) is non-zero. Therefore, if the page is missing in the replica
  DB, isValidMove() will return true, and then moveToInternal() will unconditionally delete
  the page if it can be found in the master.
severities:
  - id: 606093
    reference_id: 928475
    scoring_system: cvssv3
    value: '6.5'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N
  - id: 606092
    reference_id: 928474
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 533649
    reference_id: 880320
    scoring_system: cvssv2
    value: '4.0'
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:P/A:N
  - id: 533647
    reference_id: 880320
    scoring_system: cvssv3
    value: '4.3'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
references:
  - id: 928475
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-30159.json
    reference_id:
  - id: 7515
    url: https://lists.debian.org/debian-lts-announce/2021/05/msg00003.html
    reference_id:
  - id: 7516
    url: https://lists.debian.org/debian-lts-announce/2021/05/msg00006.html
    reference_id:
  - id: 880304
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/26UJGHF7LJDOCQN6A3Z4PM7PYRKENJHE/
    reference_id:
  - id: 880305
    url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/2OMSV7B2TCFBOCICN3B4SMQP5HVRJQIT/
    reference_id:
  - id: 880319
    url: https://phabricator.wikimedia.org/T272386
    reference_id:
  - id: 880307
    url: https://security.gentoo.org/glsa/202107-40
    reference_id:
  - id: 7514
    url: https://www.debian.org/security/2021/dsa-4889
    reference_id:
  - id: 928474
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1948638
    reference_id: '1948638'
  - id: 143908
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mediawiki:mediawiki:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:mediawiki:mediawiki:*:*:*:*:*:*:*:*
  - id: 127309
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - id: 127310
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - id: 172256
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:33:*:*:*:*:*:*:*
  - id: 169238
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:fedoraproject:fedora:34:*:*:*:*:*:*:*
  - id: 880320
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-30159
    reference_id: CVE-2021-30159
weaknesses: []
