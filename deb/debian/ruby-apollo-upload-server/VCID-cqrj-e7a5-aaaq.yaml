vulnerability_id: VCID-cqrj-e7a5-aaaq
aliases:
  - CVE-2021-39880
  - GHSA-w6pv-c757-6rgr
summary: A Denial Of Service vulnerability in the apollo_upload_server Ruby gem in GitLab CE/EE
  all versions starting from 11.9 before 14.0.9, all versions starting from 14.1 before 14.1.4,
  and all versions starting from 14.2 before 14.2.2 allows an attacker to deny access to all
  users via specially crafted requests to the apollo_upload_server middleware.
severities:
  - id: 558566
    reference_id: 896439
    scoring_system: cvssv2
    value: '4.0'
    scoring_elements: AV:N/AC:L/Au:S/C:N/I:N/A:P
  - id: 558564
    reference_id: 896439
    scoring_system: cvssv3
    value: '6.5'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
  - id: 708212
    reference_id: 1472341
    scoring_system: cvssv3.1_qr
    value: MODERATE
    scoring_elements:
references:
  - id: 1472337
    url: https://github.com/jetruby/apollo_upload_server-ruby/commit/b0582c1a3e458eee3c994fb38278bd0221f20486
    reference_id:
  - id: 1472336
    url: https://github.com/jetruby/apollo_upload_server-ruby/pull/44
    reference_id:
  - id: 1472338
    url: https://github.com/jetruby/apollo_upload_server-ruby/releases/tag/2.1.0
    reference_id:
  - id: 896436
    url: https://gitlab.com/gitlab-org/cves/-/blob/master/2021/CVE-2021-39880.json
    reference_id:
  - id: 896437
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561
    reference_id:
  - id: 1472339
    url: https://gitlab.com/gitlab-org/gitlab/-/issues/330561#note_642879964
    reference_id:
  - id: 896438
    url: https://hackerone.com/reports/1181284
    reference_id:
  - id: 1472340
    url: https://vuldb.com/?id.183842
    reference_id:
  - id: 536316
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
    reference_id: cpe:2.3:a:gitlab:gitlab:*:*:*:*:community:*:*:*
  - id: 536317
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*
    reference_id: cpe:2.3:a:gitlab:gitlab:*:*:*:*:enterprise:*:*:*
  - id: 896439
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-39880
    reference_id: CVE-2021-39880
  - id: 1472620
    url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/apollo_upload_server/CVE-2021-39880.yml
    reference_id: CVE-2021-39880.YML
  - id: 1472341
    url: https://github.com/advisories/GHSA-w6pv-c757-6rgr
    reference_id: GHSA-w6pv-c757-6rgr
weaknesses: []
