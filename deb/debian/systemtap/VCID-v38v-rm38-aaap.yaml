vulnerability_id: VCID-v38v-rm38-aaap
aliases:
  - CVE-2010-4170
summary: The staprun runtime tool in SystemTap 1.3 does not properly clear the environment before
  executing modprobe, which allows local users to gain privileges by setting the MODPROBE_OPTIONS
  environment variable to specify a malicious configuration file.
severities:
  - id: 68860
    reference_id: '198482'
    scoring_system: rhbs
    value: high
    scoring_elements:
  - id: 137475
    reference_id: 436820
    scoring_system: cvssv2
    value: '7.2'
    scoring_elements: AV:L/AC:L/Au:N/C:C/I:C/A:C
  - id: 68862
    reference_id: '198484'
    scoring_system: rhas
    value: Important
    scoring_elements:
  - id: 68861
    reference_id: '198483'
    scoring_system: rhas
    value: Moderate
    scoring_elements:
references:
  - id: 436801
    url: http://lists.fedoraproject.org/pipermail/package-announce/2010-November/051115.html
    reference_id:
  - id: 436802
    url: http://lists.fedoraproject.org/pipermail/package-announce/2010-November/051122.html
    reference_id:
  - id: 436803
    url: http://lists.fedoraproject.org/pipermail/package-announce/2010-November/051127.html
    reference_id:
  - id: 436804
    url: http://packetstormsecurity.com/files/152569/SystemTap-1.3-MODPROBE_OPTIONS-Privilege-Escalation.html
    reference_id:
  - id: '198485'
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2010-4170.json
    reference_id:
  - id: 436805
    url: http://secunia.com/advisories/42256
    reference_id:
  - id: 436806
    url: http://secunia.com/advisories/42263
    reference_id:
  - id: 436807
    url: http://secunia.com/advisories/42306
    reference_id:
  - id: 436808
    url: http://secunia.com/advisories/42318
    reference_id:
  - id: 436809
    url: http://secunia.com/advisories/46920
    reference_id:
  - id: 436818
    url: https://exchange.xforce.ibmcloud.com/vulnerabilities/63344
    reference_id:
  - id: 436810
    url: http://sources.redhat.com/git/gitweb.cgi?p=systemtap.git;a=commit;h=b7565b41228bea196cefa3a7d43ab67f8f9152e2
    reference_id:
  - id: 436811
    url: http://sources.redhat.com/ml/systemtap/2010-q4/msg00230.html
    reference_id:
  - id: 436819
    url: https://www.exploit-db.com/exploits/46730/
    reference_id:
  - id: 436812
    url: http://www.debian.org/security/2011/dsa-2348
    reference_id:
  - id: 436813
    url: http://www.exploit-db.com/exploits/15620
    reference_id:
  - id: 436814
    url: http://www.redhat.com/support/errata/RHSA-2010-0894.html
    reference_id:
  - id: 436815
    url: http://www.redhat.com/support/errata/RHSA-2010-0895.html
    reference_id:
  - id: 436816
    url: http://www.securityfocus.com/bid/44914
    reference_id:
  - id: 436817
    url: http://www.securitytracker.com/id?1024754
    reference_id:
  - id: 133486
    url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=603946
    reference_id: 603946
  - id: '198482'
    url: https://bugzilla.redhat.com/show_bug.cgi?id=653604
    reference_id: 653604
  - id: 436821
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:systemtap:systemtap:1.3:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:systemtap:systemtap:1.3:*:*:*:*:*:*:*
  - id: 436820
    url: https://nvd.nist.gov/vuln/detail/CVE-2010-4170
    reference_id: CVE-2010-4170
  - id: '198484'
    url: https://access.redhat.com/errata/RHSA-2010:0894
    reference_id: RHSA-2010:0894
  - id: '198483'
    url: https://access.redhat.com/errata/RHSA-2010:0895
    reference_id: RHSA-2010:0895
weaknesses: []
