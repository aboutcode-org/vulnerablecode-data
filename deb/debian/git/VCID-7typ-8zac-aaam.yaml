vulnerability_id: VCID-7typ-8zac-aaam
aliases:
  - CVE-2022-41903
summary: Git is distributed revision control system. `git log` can display commits in an arbitrary
  format using its `--format` specifiers. This functionality is also exposed to `git archive`
  via the `export-subst` gitattribute. When processing the padding operators, there is a integer
  overflow in `pretty.c::format_and_pad_commit()` where a `size_t` is stored improperly as an
  `int`, and then added as an offset to a `memcpy()`. This overflow can be triggered directly
  by a user running a command which invokes the commit formatting machinery (e.g., `git log
  --format=...`). It may also be triggered indirectly through git archive via the export-subst
  mechanism, which expands format specifiers inside of files within the repository during a
  git archive. This integer overflow can result in arbitrary heap writes, which may result in
  arbitrary code execution. The problem has been patched in the versions published on 2023-01-17,
  going back to v2.30.7. Users are advised to upgrade. Users who are unable to upgrade should
  disable `git archive` in untrusted repositories. If you expose git archive via `git daemon`,
  disable it by running `git config --global daemon.uploadArch false`.
severities: []
references:
  - id: 1470658
    url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=1029114
    reference_id: 1029114
weaknesses: []
