vulnerability_id: VCID-ss3b-8j2p-aaac
aliases:
  - CVE-2019-12520
summary: An issue was discovered in Squid through 4.7 and 5. When receiving a request, Squid
  checks its cache to see if it can serve up a response. It does this by making a MD5 hash of
  the absolute URL of the request. If found, it servers the request. The absolute URL can include
  the decoded UserInfo (username and password) for certain protocols. This decoded info is prepended
  to the domain. This allows an attacker to provide a username that has special characters to
  delimit the domain, and treat the rest of the URL as a path or query string. An attacker could
  first make a request to their domain using an encoded username, then when a request for the
  target domain comes in that decodes to the exact URL, it will serve the attacker's HTML instead
  of the real HTML. On Squid servers that also act as reverse proxies, this allows an attacker
  to gain access to features that only reverse proxies can use, such as ESI.
severities:
  - id: 690683
    reference_id: 1452022
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 50853
    reference_id: 175445
    scoring_system: cvssv3
    value: '7.4'
    scoring_elements: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
  - id: 690687
    reference_id: 1452024
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690688
    reference_id: 773536
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690689
    reference_id: 773537
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690690
    reference_id: 1452025
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690684
    reference_id: 1452023
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690685
    reference_id: 773534
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 690686
    reference_id: 773535
    scoring_system: generic_textual
    value: Medium
    scoring_elements:
  - id: 50851
    reference_id: 175443
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 375558
    reference_id: 773539
    scoring_system: cvssv2
    value: '5.0'
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
  - id: 375556
    reference_id: 773539
    scoring_system: cvssv3
    value: '7.5'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  - id: 50852
    reference_id: 175444
    scoring_system: rhas
    value: Moderate
    scoring_elements:
references:
  - id: 1452022
    url: http://people.canonical.com/~ubuntu-security/cve/2019/CVE-2019-12520.html
    reference_id:
  - id: 175445
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2019-12520.json
    reference_id:
  - id: 1452024
    url: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-12520
    reference_id:
  - id: 773536
    url: https://github.com/squid-cache/squid/commits/v4
    reference_id:
  - id: 773537
    url: https://gitlab.com/jeriko.one/security/-/blob/master/squid/CVEs/CVE-2019-12520.txt
    reference_id:
  - id: 745356
    url: https://lists.debian.org/debian-lts-announce/2020/07/msg00009.html
    reference_id:
  - id: 773525
    url: https://security.netapp.com/advisory/ntap-20210205-0006/
    reference_id:
  - id: 1452025
    url: https://ubuntu.com/security/notices/USN-4446-1
    reference_id:
  - id: 773538
    url: https://usn.ubuntu.com/4446-1/
    reference_id:
  - id: 773527
    url: https://www.debian.org/security/2020/dsa-4682
    reference_id:
  - id: 1452023
    url: http://www.squid-cache.org/Advisories/SQUID-2019_4.txt
    reference_id:
  - id: 773534
    url: http://www.squid-cache.org/Versions/v4/
    reference_id:
  - id: 773535
    url: http://www.squid-cache.org/Versions/v4/changesets/
    reference_id:
  - id: 175443
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1827558
    reference_id: 1827558
  - id: 159878
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:squid-cache:squid:*:*:*:*:*:*:*:*
  - id: 147844
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:16.04:*:*:*:lts:*:*:*
  - id: 168169
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
    reference_id: cpe:2.3:o:canonical:ubuntu_linux:18.04:*:*:*:lts:*:*:*
  - id: 127309
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:10.0:*:*:*:*:*:*:*
  - id: 127310
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
    reference_id: cpe:2.3:o:debian:debian_linux:9.0:*:*:*:*:*:*:*
  - id: 773539
    url: https://nvd.nist.gov/vuln/detail/CVE-2019-12520
    reference_id: CVE-2019-12520
  - id: 175444
    url: https://access.redhat.com/errata/RHSA-2020:4743
    reference_id: RHSA-2020:4743
weaknesses: []
