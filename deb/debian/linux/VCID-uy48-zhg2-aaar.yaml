vulnerability_id: VCID-uy48-zhg2-aaar
aliases:
  - CVE-2021-45100
summary: The ksmbd server through 3.4.2, as used in the Linux kernel through 5.15.8, sometimes
  communicates in cleartext even though encryption has been enabled. This occurs because it
  sets the SMB2_GLOBAL_CAP_ENCRYPTION flag when using the SMB 3.1.1 protocol, which is a violation
  of the SMB protocol specification. When Windows 10 detects this protocol violation, it disables
  encryption.
severities:
  - id: 477643
    reference_id: 844577
    scoring_system: cvssv3
    value: '7.5'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
  - id: 477642
    reference_id: 844576
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 570909
    reference_id: 905415
    scoring_system: cvssv2
    value: '5.0'
    scoring_elements: AV:N/AC:L/Au:N/C:P/I:N/A:N
  - id: 570907
    reference_id: 905415
    scoring_system: cvssv3
    value: '7.5'
    scoring_elements: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
references:
  - id: 844577
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-45100.json
    reference_id:
  - id: 905411
    url: https://github.com/cifsd-team/ksmbd/issues/550
    reference_id:
  - id: 905412
    url: https://github.com/cifsd-team/ksmbd/pull/551
    reference_id:
  - id: 905413
    url: https://marc.info/?l=linux-kernel&m=163961726017023&w=2
    reference_id:
  - id: 905414
    url: https://security.netapp.com/advisory/ntap-20220107-0001/
    reference_id:
  - id: 844576
    url: https://bugzilla.redhat.com/show_bug.cgi?id=2035345
    reference_id: 2035345
  - id: 905415
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-45100
    reference_id: CVE-2021-45100
weaknesses: []
