vulnerability_id: VCID-fqmc-mb8e-aaab
aliases:
  - CVE-2021-20328
  - GHSA-rghw-6px2-fgwc
summary: Specific versions of the Java driver that support client-side field level encryption
  (CSFLE) fail to perform correct host name verification on the KMS server’s certificate. This
  vulnerability in combination with a privileged network position active MITM attack could result
  in interception of traffic between the Java driver and the KMS service rendering Field Level
  Encryption ineffective. This issue was discovered during internal testing and affects all
  versions of the Java driver that support CSFLE. The Java async, Scala, and reactive streams
  drivers are not impacted. This vulnerability does not impact driver traffic payloads with
  CSFLE-supported key services originating from applications residing inside the AWS, GCP, and
  Azure network fabrics due to compensating controls in these environments. This issue does
  not impact driver workloads that don’t use Field Level Encryption.
severities:
  - id: 606993
    reference_id: 929138
    scoring_system: cvssv3
    value: '6.4'
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N
  - id: 606991
    reference_id: 929136
    scoring_system: rhbs
    value: medium
    scoring_elements:
  - id: 504400
    reference_id: 861632
    scoring_system: cvssv2
    value: '4.3'
    scoring_elements: AV:A/AC:M/Au:N/C:P/I:P/A:N
  - id: 504398
    reference_id: 861632
    scoring_system: cvssv3
    value: '6.8'
    scoring_elements: CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N
  - id: 630536
    reference_id: 946699
    scoring_system: cvssv3.1_qr
    value: MODERATE
    scoring_elements:
  - id: 606992
    reference_id: 929137
    scoring_system: rhas
    value: Moderate
    scoring_elements:
  - id: 602930
    reference_id: 926148
    scoring_system: rhas
    value: Moderate
    scoring_elements:
references:
  - id: 929138
    url: https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2021-20328.json
    reference_id:
  - id: 861631
    url: https://jira.mongodb.org/browse/JAVA-4017
    reference_id:
  - id: 929136
    url: https://bugzilla.redhat.com/show_bug.cgi?id=1934236
    reference_id: '1934236'
  - id: 861633
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:mongodb:java_driver:*:*:*:*:*:mongodb:*:*
    reference_id: cpe:2.3:a:mongodb:java_driver:*:*:*:*:*:mongodb:*:*
  - id: 694123
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:quarkus:quarkus:*:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:quarkus:quarkus:*:*:*:*:*:*:*:*
  - id: 861634
    url: https://nvd.nist.gov/vuln/search/results?adv_search=true&isCpeNameSearch=true&query=cpe:2.3:a:quarkus:quarkus:1.13.3:*:*:*:*:*:*:*
    reference_id: cpe:2.3:a:quarkus:quarkus:1.13.3:*:*:*:*:*:*:*
  - id: 861632
    url: https://nvd.nist.gov/vuln/detail/CVE-2021-20328
    reference_id: CVE-2021-20328
  - id: 946699
    url: https://github.com/advisories/GHSA-rghw-6px2-fgwc
    reference_id: GHSA-rghw-6px2-fgwc
  - id: 929137
    url: https://access.redhat.com/errata/RHSA-2021:0871
    reference_id: RHSA-2021:0871
  - id: 926148
    url: https://access.redhat.com/errata/RHSA-2021:4767
    reference_id: RHSA-2021:4767
weaknesses: []
