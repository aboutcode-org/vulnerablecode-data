affected_purls: []
aliases:
- CVE-2019-9858
fixed_purl:
- pkg:deb/debian/php-horde-form@2.0.18-3.1?distro=sid
- pkg:deb/debian/php-horde-form@2.0.18-3.1%2Bdeb10u1?distro=sid
- pkg:deb/debian/php-horde-form@2.0.20-2?distro=sid
references:
- id: 129022
  reference_id: '930321'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=930321
severities: []
summary: Remote code execution was discovered in Horde Groupware Webmail 5.2.22 and
  5.2.17. Horde/Form/Type.php contains a vulnerable class that handles image upload
  in forms. When the Horde_Form_Type_image method onSubmit() is called on uploads,
  it invokes the functions getImage() and _getUpload(), which uses unsanitized user
  input as a path to save the image. The unsanitized POST parameter object[photo][img][file]
  is saved in the $upload[img][file] PHP variable, allowing an attacker to manipulate
  the $tmp_file passed to move_uploaded_file() to save the uploaded file. By setting
  the parameter to (for example) ../usr/share/horde/static/bd.php, one can write a
  PHP backdoor inside the web root. The static/ destination folder is a good candidate
  to drop the backdoor because it is always writable in Horde installations. (The
  unsanitized POST parameter went probably unnoticed because it's never submitted
  by the forms, which default to securely using a random path.)
vulnerability_id: VCID-zxqt-ru6b-aaar
weaknesses: []
