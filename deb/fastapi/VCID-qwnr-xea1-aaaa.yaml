affected_purls:
- pkg:deb/debian/fastapi@0.63.0-2
- pkg:pypi/fastapi@0.1.0
- pkg:pypi/fastapi@0.10.0
- pkg:pypi/fastapi@0.10.1
- pkg:pypi/fastapi@0.10.2
- pkg:pypi/fastapi@0.1.10
- pkg:pypi/fastapi@0.11.0
- pkg:pypi/fastapi@0.1.11
- pkg:pypi/fastapi@0.1.12
- pkg:pypi/fastapi@0.1.13
- pkg:pypi/fastapi@0.1.14
- pkg:pypi/fastapi@0.1.15
- pkg:pypi/fastapi@0.1.16
- pkg:pypi/fastapi@0.1.17
- pkg:pypi/fastapi@0.1.18
- pkg:pypi/fastapi@0.1.19
- pkg:pypi/fastapi@0.1.2
- pkg:pypi/fastapi@0.12.0
- pkg:pypi/fastapi@0.12.1
- pkg:pypi/fastapi@0.1.3
- pkg:pypi/fastapi@0.13.0
- pkg:pypi/fastapi@0.1.4
- pkg:pypi/fastapi@0.14.0
- pkg:pypi/fastapi@0.1.5
- pkg:pypi/fastapi@0.15.0
- pkg:pypi/fastapi@0.1.6
- pkg:pypi/fastapi@0.16.0
- pkg:pypi/fastapi@0.1.7
- pkg:pypi/fastapi@0.17.0
- pkg:pypi/fastapi@0.1.8
- pkg:pypi/fastapi@0.18.0
- pkg:pypi/fastapi@0.1.9
- pkg:pypi/fastapi@0.19.0
- pkg:pypi/fastapi@0.2.0
- pkg:pypi/fastapi@0.20.0
- pkg:pypi/fastapi@0.20.1
- pkg:pypi/fastapi@0.2.1
- pkg:pypi/fastapi@0.21.0
- pkg:pypi/fastapi@0.22.0
- pkg:pypi/fastapi@0.23.0
- pkg:pypi/fastapi@0.24.0
- pkg:pypi/fastapi@0.25.0
- pkg:pypi/fastapi@0.26.0
- pkg:pypi/fastapi@0.27.0
- pkg:pypi/fastapi@0.27.1
- pkg:pypi/fastapi@0.27.2
- pkg:pypi/fastapi@0.28.0
- pkg:pypi/fastapi@0.29.0
- pkg:pypi/fastapi@0.29.1
- pkg:pypi/fastapi@0.3.0
- pkg:pypi/fastapi@0.30.0
- pkg:pypi/fastapi@0.30.1
- pkg:pypi/fastapi@0.31.0
- pkg:pypi/fastapi@0.32.0
- pkg:pypi/fastapi@0.33.0
- pkg:pypi/fastapi@0.34.0
- pkg:pypi/fastapi@0.35.0
- pkg:pypi/fastapi@0.36.0
- pkg:pypi/fastapi@0.37.0
- pkg:pypi/fastapi@0.38.0
- pkg:pypi/fastapi@0.38.1
- pkg:pypi/fastapi@0.39.0
- pkg:pypi/fastapi@0.4.0
- pkg:pypi/fastapi@0.40.0
- pkg:pypi/fastapi@0.41.0
- pkg:pypi/fastapi@0.42.0
- pkg:pypi/fastapi@0.43.0
- pkg:pypi/fastapi@0.44.0
- pkg:pypi/fastapi@0.44.1
- pkg:pypi/fastapi@0.45.0
- pkg:pypi/fastapi@0.46.0
- pkg:pypi/fastapi@0.47.0
- pkg:pypi/fastapi@0.47.1
- pkg:pypi/fastapi@0.48.0
- pkg:pypi/fastapi@0.49.0
- pkg:pypi/fastapi@0.49.1
- pkg:pypi/fastapi@0.49.2
- pkg:pypi/fastapi@0.5.0
- pkg:pypi/fastapi@0.50.0
- pkg:pypi/fastapi@0.5.1
- pkg:pypi/fastapi@0.51.0
- pkg:pypi/fastapi@0.52.0
- pkg:pypi/fastapi@0.53.0
- pkg:pypi/fastapi@0.53.1
- pkg:pypi/fastapi@0.53.2
- pkg:pypi/fastapi@0.54.0
- pkg:pypi/fastapi@0.54.1
- pkg:pypi/fastapi@0.54.2
- pkg:pypi/fastapi@0.55.0
- pkg:pypi/fastapi@0.55.1
- pkg:pypi/fastapi@0.56.0
- pkg:pypi/fastapi@0.56.1
- pkg:pypi/fastapi@0.57.0
- pkg:pypi/fastapi@0.58.0
- pkg:pypi/fastapi@0.58.1
- pkg:pypi/fastapi@0.59.0
- pkg:pypi/fastapi@0.6.0
- pkg:pypi/fastapi@0.60.0
- pkg:pypi/fastapi@0.60.1
- pkg:pypi/fastapi@0.60.2
- pkg:pypi/fastapi@0.6.1
- pkg:pypi/fastapi@0.61.0
- pkg:pypi/fastapi@0.61.1
- pkg:pypi/fastapi@0.61.2
- pkg:pypi/fastapi@0.6.2
- pkg:pypi/fastapi@0.62.0
- pkg:pypi/fastapi@0.6.3
- pkg:pypi/fastapi@0.63.0
- pkg:pypi/fastapi@0.6.4
- pkg:pypi/fastapi@0.64.0
- pkg:pypi/fastapi@0.65.0
- pkg:pypi/fastapi@0.65.1
- pkg:pypi/fastapi@0.7.0
- pkg:pypi/fastapi@0.7.1
- pkg:pypi/fastapi@0.8.0
- pkg:pypi/fastapi@0.9.0
- pkg:pypi/fastapi@0.9.1
aliases:
- CVE-2021-32677
- GHSA-8h2j-cgx8-6xv7
fixed_purl:
- pkg:deb/debian/fastapi@0.92.0-1
- pkg:pypi/fastapi@0.65.2
references:
- id: 160930
  reference_id: ''
  url: https://github.com/tiangolo/fastapi/commit/fa7e3c996edf2d5482fff8f9d890ac2390dede4d
- id: 160931
  reference_id: ''
  url: https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MATAWX25TYKNEKLDMKWNLYDB34UWTROA/
- id: 129803
  reference_id: '990582'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=990582
- id: 160929
  reference_id: CVE-2021-32677
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-32677
- id: 160932
  reference_id: GHSA-8h2j-cgx8-6xv7
  url: https://github.com/advisories/GHSA-8h2j-cgx8-6xv7
- id: 160928
  reference_id: GHSA-8h2j-cgx8-6xv7
  url: https://github.com/tiangolo/fastapi/security/advisories/GHSA-8h2j-cgx8-6xv7
severities:
- id: 23666
  reference_id: 160932
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
- id: 23665
  reference_id: 160928
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
summary: FastAPI is a web framework for building APIs with Python 3.6+ based on standard
  Python type hints. FastAPI versions lower than 0.65.2 that used cookies for authentication
  in path operations that received JSON payloads sent by browsers were vulnerable
  to a Cross-Site Request Forgery (CSRF) attack. In versions lower than 0.65.2, FastAPI
  would try to read the request payload as JSON even if the content-type header sent
  was not set to application/json or a compatible JSON media type (e.g. application/geo+json).
  A request with a content type of text/plain containing JSON data would be accepted
  and the JSON data would be extracted. Requests with content type text/plain are
  exempt from CORS preflights, for being considered Simple requests. The browser will
  execute them right away including cookies, and the text content could be a JSON
  string that would be parsed and accepted by the FastAPI application. This is fixed
  in FastAPI 0.65.2. The request data is now parsed as JSON only if the content-type
  header is application/json or another JSON compatible media type like application/geo+json.
  It's best to upgrade to the latest FastAPI, but if updating is not possible then
  a middleware or a dependency that checks the content-type header and aborts the
  request if it is not application/json or another JSON compatible content type can
  act as a mitigating workaround.
vulnerability_id: VCID-qwnr-xea1-aaaa
weaknesses: []
