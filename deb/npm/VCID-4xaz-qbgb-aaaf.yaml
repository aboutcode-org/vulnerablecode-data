affected_purls:
- pkg:deb/debian/npm@5.8.0%2Bds6-4%2Bdeb10u2
- pkg:deb/debian/npm@7.5.2%2Bds-2
- pkg:npm/%40npmcli/arborist@0.0.0
- pkg:npm/%40npmcli/arborist@0.0.0-pre.0
- pkg:npm/%40npmcli/arborist@0.0.0-pre.1
- pkg:npm/%40npmcli/arborist@0.0.0-pre.10
- pkg:npm/%40npmcli/arborist@0.0.0-pre.11
- pkg:npm/%40npmcli/arborist@0.0.0-pre.12
- pkg:npm/%40npmcli/arborist@0.0.0-pre.13
- pkg:npm/%40npmcli/arborist@0.0.0-pre.14
- pkg:npm/%40npmcli/arborist@0.0.0-pre.15
- pkg:npm/%40npmcli/arborist@0.0.0-pre.16
- pkg:npm/%40npmcli/arborist@0.0.0-pre.17
- pkg:npm/%40npmcli/arborist@0.0.0-pre.18
- pkg:npm/%40npmcli/arborist@0.0.0-pre.19
- pkg:npm/%40npmcli/arborist@0.0.0-pre.2
- pkg:npm/%40npmcli/arborist@0.0.0-pre.20
- pkg:npm/%40npmcli/arborist@0.0.0-pre.21
- pkg:npm/%40npmcli/arborist@0.0.0-pre.3
- pkg:npm/%40npmcli/arborist@0.0.0-pre.4
- pkg:npm/%40npmcli/arborist@0.0.0-pre.5
- pkg:npm/%40npmcli/arborist@0.0.0-pre.6
- pkg:npm/%40npmcli/arborist@0.0.0-pre.7
- pkg:npm/%40npmcli/arborist@0.0.0-pre.8
- pkg:npm/%40npmcli/arborist@0.0.0-pre.9
- pkg:npm/%40npmcli/arborist@0.0.1
- pkg:npm/%40npmcli/arborist@0.0.10
- pkg:npm/%40npmcli/arborist@0.0.11
- pkg:npm/%40npmcli/arborist@0.0.12
- pkg:npm/%40npmcli/arborist@0.0.13
- pkg:npm/%40npmcli/arborist@0.0.14
- pkg:npm/%40npmcli/arborist@0.0.15
- pkg:npm/%40npmcli/arborist@0.0.16
- pkg:npm/%40npmcli/arborist@0.0.17
- pkg:npm/%40npmcli/arborist@0.0.18
- pkg:npm/%40npmcli/arborist@0.0.19
- pkg:npm/%40npmcli/arborist@0.0.2
- pkg:npm/%40npmcli/arborist@0.0.20
- pkg:npm/%40npmcli/arborist@0.0.21
- pkg:npm/%40npmcli/arborist@0.0.22
- pkg:npm/%40npmcli/arborist@0.0.23
- pkg:npm/%40npmcli/arborist@0.0.24
- pkg:npm/%40npmcli/arborist@0.0.25
- pkg:npm/%40npmcli/arborist@0.0.26
- pkg:npm/%40npmcli/arborist@0.0.27
- pkg:npm/%40npmcli/arborist@0.0.28
- pkg:npm/%40npmcli/arborist@0.0.29
- pkg:npm/%40npmcli/arborist@0.0.3
- pkg:npm/%40npmcli/arborist@0.0.30
- pkg:npm/%40npmcli/arborist@0.0.31
- pkg:npm/%40npmcli/arborist@0.0.32
- pkg:npm/%40npmcli/arborist@0.0.33
- pkg:npm/%40npmcli/arborist@0.0.4
- pkg:npm/%40npmcli/arborist@0.0.5
- pkg:npm/%40npmcli/arborist@0.0.6
- pkg:npm/%40npmcli/arborist@0.0.7
- pkg:npm/%40npmcli/arborist@0.0.8
- pkg:npm/%40npmcli/arborist@0.0.9
- pkg:npm/%40npmcli/arborist@1.0.0
- pkg:npm/%40npmcli/arborist@1.0.1
- pkg:npm/%40npmcli/arborist@1.0.10
- pkg:npm/%40npmcli/arborist@1.0.11
- pkg:npm/%40npmcli/arborist@1.0.12
- pkg:npm/%40npmcli/arborist@1.0.13
- pkg:npm/%40npmcli/arborist@1.0.14
- pkg:npm/%40npmcli/arborist@1.0.2
- pkg:npm/%40npmcli/arborist@1.0.3
- pkg:npm/%40npmcli/arborist@1.0.4
- pkg:npm/%40npmcli/arborist@1.0.5
- pkg:npm/%40npmcli/arborist@1.0.6
- pkg:npm/%40npmcli/arborist@1.0.7
- pkg:npm/%40npmcli/arborist@1.0.8
- pkg:npm/%40npmcli/arborist@1.0.9
- pkg:npm/%40npmcli/arborist@2.0.0
- pkg:npm/%40npmcli/arborist@2.0.1
- pkg:npm/%40npmcli/arborist@2.0.2
- pkg:npm/%40npmcli/arborist@2.0.3
- pkg:npm/%40npmcli/arborist@2.0.4
- pkg:npm/%40npmcli/arborist@2.0.5
- pkg:npm/%40npmcli/arborist@2.0.6
- pkg:npm/%40npmcli/arborist@2.1.0
- pkg:npm/%40npmcli/arborist@2.1.1
- pkg:npm/%40npmcli/arborist@2.2.0
- pkg:npm/%40npmcli/arborist@2.2.1
- pkg:npm/%40npmcli/arborist@2.2.2
- pkg:npm/%40npmcli/arborist@2.2.3
- pkg:npm/%40npmcli/arborist@2.2.4
- pkg:npm/%40npmcli/arborist@2.2.5
- pkg:npm/%40npmcli/arborist@2.2.6
- pkg:npm/%40npmcli/arborist@2.2.7
- pkg:npm/%40npmcli/arborist@2.2.8
- pkg:npm/%40npmcli/arborist@2.2.9
- pkg:npm/%40npmcli/arborist@2.3.0
- pkg:npm/%40npmcli/arborist@2.4.0
- pkg:npm/%40npmcli/arborist@2.4.1
- pkg:npm/%40npmcli/arborist@2.4.2
- pkg:npm/%40npmcli/arborist@2.4.3
- pkg:npm/%40npmcli/arborist@2.4.4
- pkg:npm/%40npmcli/arborist@2.5.0
- pkg:npm/%40npmcli/arborist@2.6.0
- pkg:npm/%40npmcli/arborist@2.6.1
- pkg:npm/%40npmcli/arborist@2.6.2
- pkg:npm/%40npmcli/arborist@2.6.3
- pkg:npm/%40npmcli/arborist@2.6.4
- pkg:npm/%40npmcli/arborist@2.7.0
- pkg:npm/%40npmcli/arborist@2.7.1
- pkg:npm/%40npmcli/arborist@2.8.0
- pkg:npm/%40npmcli/arborist@2.8.1
aliases:
- CVE-2021-39134
- GHSA-2h3h-q99f-3fhc
fixed_purl:
- pkg:deb/debian/npm@7.4.0%2Bds-1~bpo10%2B2
- pkg:deb/debian/npm@8.5.5~ds1-1~bpo11%2B1
- pkg:npm/%40npmcli/arborist@2.8.2
references:
- id: 155947
  reference_id: ''
  url: https://cert-portal.siemens.com/productcert/pdf/ssa-389290.pdf
- id: 162770
  reference_id: ''
  url: https://www.npmjs.com/package/@npmcli/arborist
- id: 136182
  reference_id: ''
  url: https://www.oracle.com/security-alerts/cpuoct2021.html
- id: 130020
  reference_id: '993407'
  url: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=993407
- id: 162771
  reference_id: CVE-2021-39134
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-39134
- id: 162772
  reference_id: GHSA-2h3h-q99f-3fhc
  url: https://github.com/advisories/GHSA-2h3h-q99f-3fhc
- id: 162769
  reference_id: GHSA-2h3h-q99f-3fhc
  url: https://github.com/npm/arborist/security/advisories/GHSA-2h3h-q99f-3fhc
severities:
- id: 24181
  reference_id: 162772
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
- id: 24180
  reference_id: 162769
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: HIGH
summary: '`@npmcli/arborist`, the library that calculates dependency trees and manages
  the `node_modules` folder hierarchy for the npm command line interface, aims to
  guarantee that package dependency contracts will be met, and the extraction of package
  contents will always be performed into the expected folder. This is, in part, accomplished
  by resolving dependency specifiers defined in `package.json` manifests for dependencies
  with a specific name, and nesting folders to resolve conflicting dependencies. When
  multiple dependencies differ only in the case of their name, Arborist''s internal
  data structure saw them as separate items that could coexist within the same level
  in the `node_modules` hierarchy. However, on case-insensitive file systems (such
  as macOS and Windows), this is not the case. Combined with a symlink dependency
  such as `file:/some/path`, this allowed an attacker to create a situation in which
  arbitrary contents could be written to any location on the filesystem. For example,
  a package `pwn-a` could define a dependency in their `package.json` file such as
  `"foo": "file:/some/path"`. Another package, `pwn-b` could define a dependency such
  as `FOO: "file:foo.tgz"`. On case-insensitive file systems, if `pwn-a` was installed,
  and then `pwn-b` was installed afterwards, the contents of `foo.tgz` would be written
  to `/some/path`, and any existing contents of `/some/path` would be removed. Anyone
  using npm v7.20.6 or earlier on a case-insensitive filesystem is potentially affected.
  This is patched in @npmcli/arborist 2.8.2 which is included in npm v7.20.7 and above.'
vulnerability_id: VCID-4xaz-qbgb-aaaf
weaknesses: []
