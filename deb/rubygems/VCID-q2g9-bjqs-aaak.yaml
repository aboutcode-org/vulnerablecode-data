affected_purls:
- pkg:deb/debian/rubygems@3.2.5-2
- pkg:gem/bundler@0.3.0
- pkg:gem/bundler@0.3.1
- pkg:gem/bundler@0.4.0
- pkg:gem/bundler@0.4.1
- pkg:gem/bundler@0.5.0
- pkg:gem/bundler@0.6.0
- pkg:gem/bundler@0.7.0
- pkg:gem/bundler@0.7.1
- pkg:gem/bundler@0.7.2
- pkg:gem/bundler@0.7.3.pre
- pkg:gem/bundler@0.7.3.pre2
- pkg:gem/bundler@0.8.0
- pkg:gem/bundler@0.8.1
- pkg:gem/bundler@0.9.0
- pkg:gem/bundler@0.9.0.pre1
- pkg:gem/bundler@0.9.0.pre2
- pkg:gem/bundler@0.9.0.pre3
- pkg:gem/bundler@0.9.0.pre4
- pkg:gem/bundler@0.9.0.pre5
- pkg:gem/bundler@0.9.1
- pkg:gem/bundler@0.9.10
- pkg:gem/bundler@0.9.11
- pkg:gem/bundler@0.9.12
- pkg:gem/bundler@0.9.13
- pkg:gem/bundler@0.9.14
- pkg:gem/bundler@0.9.15
- pkg:gem/bundler@0.9.16
- pkg:gem/bundler@0.9.17
- pkg:gem/bundler@0.9.18
- pkg:gem/bundler@0.9.19
- pkg:gem/bundler@0.9.1.pre1
- pkg:gem/bundler@0.9.2
- pkg:gem/bundler@0.9.20
- pkg:gem/bundler@0.9.21
- pkg:gem/bundler@0.9.22
- pkg:gem/bundler@0.9.23
- pkg:gem/bundler@0.9.24
- pkg:gem/bundler@0.9.25
- pkg:gem/bundler@0.9.26
- pkg:gem/bundler@0.9.3
- pkg:gem/bundler@0.9.4
- pkg:gem/bundler@0.9.5
- pkg:gem/bundler@0.9.6
- pkg:gem/bundler@0.9.7
- pkg:gem/bundler@0.9.8
- pkg:gem/bundler@0.9.9
- pkg:gem/bundler@1.0.0
- pkg:gem/bundler@1.0.0.beta.1
- pkg:gem/bundler@1.0.0.beta.10
- pkg:gem/bundler@1.0.0.beta.2
- pkg:gem/bundler@1.0.0.beta.3
- pkg:gem/bundler@1.0.0.beta.4
- pkg:gem/bundler@1.0.0.beta.5
- pkg:gem/bundler@1.0.0.beta.8
- pkg:gem/bundler@1.0.0.beta.9
- pkg:gem/bundler@1.0.0.rc.1
- pkg:gem/bundler@1.0.0.rc.2
- pkg:gem/bundler@1.0.0.rc.3
- pkg:gem/bundler@1.0.0.rc.5
- pkg:gem/bundler@1.0.0.rc.6
- pkg:gem/bundler@1.0.10
- pkg:gem/bundler@1.0.11
- pkg:gem/bundler@1.0.12
- pkg:gem/bundler@1.0.13
- pkg:gem/bundler@1.0.14
- pkg:gem/bundler@1.0.15
- pkg:gem/bundler@1.0.17
- pkg:gem/bundler@1.0.18
- pkg:gem/bundler@1.0.19.rc
- pkg:gem/bundler@1.0.2
- pkg:gem/bundler@1.0.20
- pkg:gem/bundler@1.0.20.rc
- pkg:gem/bundler@1.0.21
- pkg:gem/bundler@1.0.21.rc
- pkg:gem/bundler@1.0.22
- pkg:gem/bundler@1.0.3
- pkg:gem/bundler@1.0.5
- pkg:gem/bundler@1.0.7
- pkg:gem/bundler@1.0.9
- pkg:gem/bundler@1.1.0
- pkg:gem/bundler@1.10.0
- pkg:gem/bundler@1.10.0.pre
- pkg:gem/bundler@1.10.0.pre.1
- pkg:gem/bundler@1.10.0.pre.2
- pkg:gem/bundler@1.10.0.rc
- pkg:gem/bundler@1.10.1
- pkg:gem/bundler@1.10.2
- pkg:gem/bundler@1.10.3
- pkg:gem/bundler@1.10.4
- pkg:gem/bundler@1.10.5
- pkg:gem/bundler@1.10.6
- pkg:gem/bundler@1.1.1
- pkg:gem/bundler@1.11.0
- pkg:gem/bundler@1.11.0.pre.1
- pkg:gem/bundler@1.11.0.pre.2
- pkg:gem/bundler@1.11.1
- pkg:gem/bundler@1.11.2
- pkg:gem/bundler@1.1.2
- pkg:gem/bundler@1.12.0
- pkg:gem/bundler@1.12.0.pre.1
- pkg:gem/bundler@1.12.0.pre.2
- pkg:gem/bundler@1.12.0.rc
- pkg:gem/bundler@1.12.0.rc.2
- pkg:gem/bundler@1.12.0.rc.3
- pkg:gem/bundler@1.12.0.rc.4
- pkg:gem/bundler@1.12.1
- pkg:gem/bundler@1.12.2
- pkg:gem/bundler@1.12.3
- pkg:gem/bundler@1.12.4
- pkg:gem/bundler@1.12.5
- pkg:gem/bundler@1.12.6
- pkg:gem/bundler@1.1.3
- pkg:gem/bundler@1.13.0
- pkg:gem/bundler@1.13.0.pre.1
- pkg:gem/bundler@1.13.0.rc.1
- pkg:gem/bundler@1.13.0.rc.2
- pkg:gem/bundler@1.13.1
- pkg:gem/bundler@1.13.2
- pkg:gem/bundler@1.13.3
- pkg:gem/bundler@1.13.4
- pkg:gem/bundler@1.13.5
- pkg:gem/bundler@1.13.6
- pkg:gem/bundler@1.13.7
- pkg:gem/bundler@1.1.4
- pkg:gem/bundler@1.14.0
- pkg:gem/bundler@1.14.0.pre.1
- pkg:gem/bundler@1.14.0.pre.2
- pkg:gem/bundler@1.14.1
- pkg:gem/bundler@1.14.2
- pkg:gem/bundler@1.14.3
- pkg:gem/bundler@1.14.4
- pkg:gem/bundler@1.14.5
- pkg:gem/bundler@1.14.6
- pkg:gem/bundler@1.1.5
- pkg:gem/bundler@1.15.0
- pkg:gem/bundler@1.15.0.pre.1
- pkg:gem/bundler@1.15.0.pre.2
- pkg:gem/bundler@1.15.0.pre.3
- pkg:gem/bundler@1.15.0.pre.4
- pkg:gem/bundler@1.15.1
- pkg:gem/bundler@1.15.2
- pkg:gem/bundler@1.15.3
- pkg:gem/bundler@1.15.4
- pkg:gem/bundler@1.16.0
- pkg:gem/bundler@1.16.0.pre.1
- pkg:gem/bundler@1.16.0.pre.2
- pkg:gem/bundler@1.16.0.pre.3
- pkg:gem/bundler@1.16.1
- pkg:gem/bundler@1.16.2
- pkg:gem/bundler@1.16.3
- pkg:gem/bundler@1.16.4
- pkg:gem/bundler@1.16.5
- pkg:gem/bundler@1.16.6
- pkg:gem/bundler@1.17.0
- pkg:gem/bundler@1.17.0.pre.1
- pkg:gem/bundler@1.17.0.pre.2
- pkg:gem/bundler@1.17.1
- pkg:gem/bundler@1.17.2
- pkg:gem/bundler@1.17.3
- pkg:gem/bundler@1.1.pre
- pkg:gem/bundler@1.1.pre.1
- pkg:gem/bundler@1.1.pre.10
- pkg:gem/bundler@1.1.pre.2
- pkg:gem/bundler@1.1.pre.3
- pkg:gem/bundler@1.1.pre.4
- pkg:gem/bundler@1.1.pre.5
- pkg:gem/bundler@1.1.pre.7
- pkg:gem/bundler@1.1.pre.8
- pkg:gem/bundler@1.1.pre.9
- pkg:gem/bundler@1.1.rc
- pkg:gem/bundler@1.1.rc.2
- pkg:gem/bundler@1.1.rc.3
- pkg:gem/bundler@1.1.rc.5
- pkg:gem/bundler@1.1.rc.6
- pkg:gem/bundler@1.1.rc.7
- pkg:gem/bundler@1.1.rc.8
- pkg:gem/bundler@1.2.0
- pkg:gem/bundler@1.2.0.pre
- pkg:gem/bundler@1.2.0.pre.1
- pkg:gem/bundler@1.2.0.rc
- pkg:gem/bundler@1.2.0.rc.2
- pkg:gem/bundler@1.2.1
- pkg:gem/bundler@1.2.2
- pkg:gem/bundler@1.2.3
- pkg:gem/bundler@1.2.4
- pkg:gem/bundler@1.2.5
- pkg:gem/bundler@1.3.0
- pkg:gem/bundler@1.3.0.pre
- pkg:gem/bundler@1.3.0.pre.2
- pkg:gem/bundler@1.3.0.pre.3
- pkg:gem/bundler@1.3.0.pre.4
- pkg:gem/bundler@1.3.0.pre.5
- pkg:gem/bundler@1.3.0.pre.6
- pkg:gem/bundler@1.3.0.pre.7
- pkg:gem/bundler@1.3.0.pre.8
- pkg:gem/bundler@1.3.1
- pkg:gem/bundler@1.3.2
- pkg:gem/bundler@1.3.3
- pkg:gem/bundler@1.3.4
- pkg:gem/bundler@1.3.5
- pkg:gem/bundler@1.3.6
- pkg:gem/bundler@1.4.0.pre.1
- pkg:gem/bundler@1.4.0.pre.2
- pkg:gem/bundler@1.4.0.rc.1
- pkg:gem/bundler@1.5.0
- pkg:gem/bundler@1.5.0.rc.1
- pkg:gem/bundler@1.5.0.rc.2
- pkg:gem/bundler@1.5.1
- pkg:gem/bundler@1.5.2
- pkg:gem/bundler@1.5.3
- pkg:gem/bundler@1.6.0
- pkg:gem/bundler@1.6.0.pre.1
- pkg:gem/bundler@1.6.0.pre.2
- pkg:gem/bundler@1.6.0.rc
- pkg:gem/bundler@1.6.0.rc2
- pkg:gem/bundler@1.6.1
- pkg:gem/bundler@1.6.2
- pkg:gem/bundler@1.6.3
- pkg:gem/bundler@1.6.4
- pkg:gem/bundler@1.6.5
- pkg:gem/bundler@1.6.6
- pkg:gem/bundler@1.6.7
- pkg:gem/bundler@1.6.8
- pkg:gem/bundler@1.6.9
- pkg:gem/bundler@1.7.0
- pkg:gem/bundler@1.7.1
- pkg:gem/bundler@1.7.10
- pkg:gem/bundler@1.7.11
- pkg:gem/bundler@1.7.12
- pkg:gem/bundler@1.7.13
- pkg:gem/bundler@1.7.14
- pkg:gem/bundler@1.7.15
- pkg:gem/bundler@1.7.1.pre
- pkg:gem/bundler@1.7.1.pre.2
- pkg:gem/bundler@1.7.1.pre.3
- pkg:gem/bundler@1.7.2
- pkg:gem/bundler@1.7.3
- pkg:gem/bundler@1.7.4
- pkg:gem/bundler@1.7.5
- pkg:gem/bundler@1.7.6
- pkg:gem/bundler@1.7.7
- pkg:gem/bundler@1.7.8
- pkg:gem/bundler@1.7.9
- pkg:gem/bundler@1.8.0
- pkg:gem/bundler@1.8.0.pre
- pkg:gem/bundler@1.8.1
- pkg:gem/bundler@1.8.2
- pkg:gem/bundler@1.8.3
- pkg:gem/bundler@1.8.4
- pkg:gem/bundler@1.8.5
- pkg:gem/bundler@1.8.6
- pkg:gem/bundler@1.8.7
- pkg:gem/bundler@1.8.8
- pkg:gem/bundler@1.8.9
- pkg:gem/bundler@1.9.0
- pkg:gem/bundler@1.9.0.pre
- pkg:gem/bundler@1.9.0.pre.1
- pkg:gem/bundler@1.9.0.rc
- pkg:gem/bundler@1.9.1
- pkg:gem/bundler@1.9.10
- pkg:gem/bundler@1.9.2
- pkg:gem/bundler@1.9.3
- pkg:gem/bundler@1.9.4
- pkg:gem/bundler@1.9.5
- pkg:gem/bundler@1.9.6
- pkg:gem/bundler@1.9.7
- pkg:gem/bundler@1.9.8
- pkg:gem/bundler@1.9.9
- pkg:gem/bundler@2.0.0
- pkg:gem/bundler@2.0.0.pre.1
- pkg:gem/bundler@2.0.0.pre.2
- pkg:gem/bundler@2.0.0.pre.3
- pkg:gem/bundler@2.0.1
- pkg:gem/bundler@2.0.2
- pkg:gem/bundler@2.1.0
- pkg:gem/bundler@2.1.0.pre.1
- pkg:gem/bundler@2.1.0.pre.2
- pkg:gem/bundler@2.1.0.pre.3
- pkg:gem/bundler@2.1.1
- pkg:gem/bundler@2.1.2
- pkg:gem/bundler@2.1.3
- pkg:gem/bundler@2.1.4
- pkg:gem/bundler@2.2.0
- pkg:gem/bundler@2.2.0.rc.1
- pkg:gem/bundler@2.2.0.rc.2
- pkg:gem/bundler@2.2.1
- pkg:gem/bundler@2.2.10
- pkg:gem/bundler@2.2.11
- pkg:gem/bundler@2.2.12
- pkg:gem/bundler@2.2.13
- pkg:gem/bundler@2.2.14
- pkg:gem/bundler@2.2.15
- pkg:gem/bundler@2.2.16
- pkg:gem/bundler@2.2.17
- pkg:gem/bundler@2.2.18
- pkg:gem/bundler@2.2.19
- pkg:gem/bundler@2.2.2
- pkg:gem/bundler@2.2.20
- pkg:gem/bundler@2.2.21
- pkg:gem/bundler@2.2.22
- pkg:gem/bundler@2.2.23
- pkg:gem/bundler@2.2.24
- pkg:gem/bundler@2.2.25
- pkg:gem/bundler@2.2.26
- pkg:gem/bundler@2.2.27
- pkg:gem/bundler@2.2.28
- pkg:gem/bundler@2.2.29
- pkg:gem/bundler@2.2.3
- pkg:gem/bundler@2.2.30
- pkg:gem/bundler@2.2.31
- pkg:gem/bundler@2.2.32
- pkg:gem/bundler@2.2.4
- pkg:gem/bundler@2.2.5
- pkg:gem/bundler@2.2.6
- pkg:gem/bundler@2.2.7
- pkg:gem/bundler@2.2.8
- pkg:gem/bundler@2.2.9
aliases:
- CVE-2021-43809
- GHSA-fj7f-vq84-fh43
fixed_purl:
- pkg:deb/debian/rubygems@3.3.15-2
- pkg:gem/bundler@2.2.33
references:
- id: 164571
  reference_id: ''
  url: https://github.com/rubygems/rubygems/commit/0fad1ccfe9dd7a3c5b82c1496df3c2b4842870d3
- id: 164572
  reference_id: ''
  url: https://github.com/rubygems/rubygems/commit/a4f2f8ac17e6ce81c689527a8b6f14381060d95f
- id: 164570
  reference_id: ''
  url: https://github.com/rubygems/rubygems/pull/5142
- id: 164573
  reference_id: CVE-2021-43809
  url: https://nvd.nist.gov/vuln/detail/CVE-2021-43809
- id: 164574
  reference_id: CVE-2021-43809.YML
  url: https://github.com/rubysec/ruby-advisory-db/blob/master/gems/bundler/CVE-2021-43809.yml
- id: 164575
  reference_id: GHSA-fj7f-vq84-fh43
  url: https://github.com/advisories/GHSA-fj7f-vq84-fh43
- id: 164569
  reference_id: GHSA-fj7f-vq84-fh43
  url: https://github.com/rubygems/rubygems/security/advisories/GHSA-fj7f-vq84-fh43
severities:
- id: 24711
  reference_id: 164575
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: MODERATE
- id: 24710
  reference_id: 164569
  scoring_elements: ''
  scoring_system: cvssv3.1_qr
  value: MODERATE
summary: '`Bundler` is a package for managing application dependencies in Ruby. In
  `bundler` versions before 2.2.33, when working with untrusted and apparently harmless
  `Gemfile`''s, it is not expected that they lead to execution of external code, unless
  that''s explicit in the ruby code inside the `Gemfile` itself. However, if the `Gemfile`
  includes `gem` entries that use the `git` option with invalid, but seemingly harmless,
  values with a leading dash, this can be false. To handle dependencies that come
  from a Git repository instead of a registry, Bundler uses various commands, such
  as `git clone`. These commands are being constructed using user input (e.g. the
  repository URL). When building the commands, Bundler versions before 2.2.33 correctly
  avoid Command Injection vulnerabilities by passing an array of arguments instead
  of a command string. However, there is the possibility that a user input starts
  with a dash (`-`) and is therefore treated as an optional argument instead of a
  positional one. This can lead to Code Execution because some of the commands have
  options that can be leveraged to run arbitrary executables. Since this value comes
  from the `Gemfile` file, it can contain any character, including a leading dash.
  To exploit this vulnerability, an attacker has to craft a directory containing a
  `Gemfile` file that declares a dependency that is located in a Git repository. This
  dependency has to have a Git URL in the form of `-u./payload`. This URL will be
  used to construct a Git clone command but will be interpreted as the upload-pack
  argument. Then this directory needs to be shared with the victim, who then needs
  to run a command that evaluates the Gemfile, such as `bundle lock`, inside. This
  vulnerability can lead to Arbitrary Code Execution, which could potentially lead
  to the takeover of the system. However, the exploitability is very low, because
  it requires a lot of user interaction. Bundler 2.2.33 has patched this problem by
  inserting `--` as an argument before any positional arguments to those Git commands
  that were affected by this issue. Regardless of whether users can upgrade or not,
  they should review any untrustred `Gemfile`''s before running any `bundler` commands
  that may read them, since they can contain arbitrary ruby code.'
vulnerability_id: VCID-q2g9-bjqs-aaak
weaknesses: []
